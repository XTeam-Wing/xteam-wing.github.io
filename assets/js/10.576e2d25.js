(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{336:function(n,s,t){"use strict";t.r(s);var e=t(10),a=Object(e.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("p",[n._v("简单封装了一下阿里云的openapi,作用就是:")]),n._v(" "),s("ul",[s("li",[n._v("创建指定数量的抢占式实例")]),n._v(" "),s("li",[n._v("销毁实例")]),n._v(" "),s("li",[n._v("执行命令")])]),n._v(" "),s("div",{staticClass:"language-golang line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('package aliyun\n\nimport (\n\t"encoding/base64"\n\n\topenapi "github.com/alibabacloud-go/darabonba-openapi/v2/client"\n\tecs20140526 "github.com/alibabacloud-go/ecs-20140526/v3/client"\n\tutil "github.com/alibabacloud-go/tea-utils/v2/service"\n\t"github.com/alibabacloud-go/tea/tea"\n)\n\ntype AyunClient struct {\n\tAK     string\n\tSK     string\n\tClient *ecs20140526.Client\n}\n\n/**\n * 使用AK&SK初始化账号Client\n * @param accessKeyId\n * @param accessKeySecret\n * @return Client\n * @throws Exception\n */\n\nfunc (ayun *AyunClient) Init() (err error) {\n\terr = ayun.CreateClient()\n\tif err != nil {\n\t\treturn err\n\t}\n\treturn nil\n}\nfunc (ayun *AyunClient) CreateClient() (_err error) {\n\tayunConfig := &openapi.Config{\n\t\t// 必填，您的 AccessKey ID\n\t\tAccessKeyId: &ayun.AK,\n\t\t// 必填，您的 AccessKey Secret\n\t\tAccessKeySecret: &ayun.SK,\n\t}\n\t// 访问的域名\n\tayunConfig.Endpoint = tea.String("ecs-cn-hangzhou.aliyuncs.com")\n\n\tayun.Client, _err = ecs20140526.NewClient(ayunConfig)\n\treturn _err\n}\nfunc (ayun *AyunClient) CreateECS(Amount int, password string) (InstanceID []*string, err error) {\n\t// 请确保代码运行环境设置了环境变量 ALIBABA_CLOUD_ACCESS_KEY_ID 和 ALIBABA_CLOUD_ACCESS_KEY_SECRET。\n\t// 工程代码泄露可能会导致 AccessKey 泄露，并威胁账号下所有资源的安全性。以下代码示例使用环境变量获取 AccessKey 的方式进行调用，仅供参考，建议使用更安全的 STS 方式，更多鉴权访问方式请参见：https://help.aliyun.com/document_detail/378661.html\n\n\tsystemDisk := &ecs20140526.RunInstancesRequestSystemDisk{\n\t\tDiskName:         tea.String(""),\n\t\tCategory:         tea.String("cloud_essd"),\n\t\tPerformanceLevel: tea.String("PL0"),\n\t\tSize:             tea.String("40"),\n\t}\n\n\trunInstancesRequest := &ecs20140526.RunInstancesRequest{\n\t\tRegionId:                    tea.String("cn-hangzhou"),\n\t\tSystemDisk:                  systemDisk,\n\t\tImageId:                     tea.String("m-xx"),\n\t\tInstanceType:                tea.String("xx"),\n\t\tSecurityGroupId:             tea.String("sgxx"),\n\t\tInstanceName:                tea.String("xx-node"),\n\t\tVSwitchId:                   tea.String("vsw-xx"),\n\t\tInternetMaxBandwidthOut:     tea.Int32(10),\n\t\tUniqueSuffix:                tea.Bool(true),\n\t\tPassword:                    tea.String(password),\n\t\tInternetChargeType:          tea.String("PayByTraffic"),\n\t\tAmount:                      tea.Int32(int32(Amount)),\n\t\tSpotStrategy:                tea.String("SpotAsPriceGo"),\n\t\tSpotDuration:                tea.Int32(0),\n\t\tSecurityEnhancementStrategy: tea.String("Active"),\n\t\tInstanceChargeType:          tea.String("PostPaid"),\n\t}\n\truntime := &util.RuntimeOptions{}\n\tresp, err := ayun.Client.RunInstancesWithOptions(runInstancesRequest, runtime)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\treturn resp.Body.InstanceIdSets.InstanceIdSet, err\n}\n\nfunc (ayun *AyunClient) CreateInvokeId(instanceId, command string) (InvokeId string, err error) {\n\n\tcreateCommandRequest := &ecs20140526.CreateCommandRequest{\n\t\tType:           tea.String("RunShellScript"),\n\t\tRegionId:       tea.String("cn-hangzhou"),\n\t\tName:           tea.String("cmd"),\n\t\tCommandContent: tea.String(base64.StdEncoding.EncodeToString([]byte(command))),\n\t\tTimeout:        tea.Int64(600),\n\t}\n\tresult, err := ayun.Client.CreateCommandWithOptions(createCommandRequest, &util.RuntimeOptions{})\n\tif err != nil {\n\t\treturn "", err\n\t}\n\tinvokeCommandRequest := &ecs20140526.InvokeCommandRequest{\n\t\tRegionId:   tea.String("cn-hangzhou"),\n\t\tCommandId:  tea.String(*result.Body.CommandId),\n\t\tInstanceId: []*string{tea.String(instanceId)},\n\t}\n\tresp, err := ayun.Client.InvokeCommandWithOptions(invokeCommandRequest, &util.RuntimeOptions{})\n\tif err != nil {\n\t\treturn "", err\n\t}\n\treturn *resp.Body.InvokeId, err\n\n}\nfunc (ayun *AyunClient) GetCmdResult(InvokeId string) (result string, err error) {\n\tdescribeInvocationResultsRequest := &ecs20140526.DescribeInvocationResultsRequest{\n\t\tRegionId: tea.String("cn-hangzhou"),\n\t\tInvokeId: tea.String(InvokeId),\n\t\t// CommandId: tea.String(CommandId),\n\t}\n\truntime := &util.RuntimeOptions{}\n\tresp, err := ayun.Client.DescribeInvocationResultsWithOptions(describeInvocationResultsRequest, runtime)\n\tif err != nil {\n\t\treturn "", err\n\t}\n\treturn *resp.Body.Invocation.InvocationResults.InvocationResult[0].Output, nil\n}\n\nfunc (ayun *AyunClient) DestroyInstances(InstanceID string) (result int32, err error) {\n\tdeleteInstanceRequest := &ecs20140526.DeleteInstanceRequest{\n\t\tInstanceId: tea.String(InstanceID),\n\t\tForce:      tea.Bool(true),\n\t}\n\truntime := &util.RuntimeOptions{}\n\tresp, err := ayun.Client.DeleteInstanceWithOptions(deleteInstanceRequest, runtime)\n\tif err != nil {\n\t\treturn result, err\n\t}\n\n\treturn *resp.StatusCode, nil\n}\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br"),s("span",{staticClass:"line-number"},[n._v("47")]),s("br"),s("span",{staticClass:"line-number"},[n._v("48")]),s("br"),s("span",{staticClass:"line-number"},[n._v("49")]),s("br"),s("span",{staticClass:"line-number"},[n._v("50")]),s("br"),s("span",{staticClass:"line-number"},[n._v("51")]),s("br"),s("span",{staticClass:"line-number"},[n._v("52")]),s("br"),s("span",{staticClass:"line-number"},[n._v("53")]),s("br"),s("span",{staticClass:"line-number"},[n._v("54")]),s("br"),s("span",{staticClass:"line-number"},[n._v("55")]),s("br"),s("span",{staticClass:"line-number"},[n._v("56")]),s("br"),s("span",{staticClass:"line-number"},[n._v("57")]),s("br"),s("span",{staticClass:"line-number"},[n._v("58")]),s("br"),s("span",{staticClass:"line-number"},[n._v("59")]),s("br"),s("span",{staticClass:"line-number"},[n._v("60")]),s("br"),s("span",{staticClass:"line-number"},[n._v("61")]),s("br"),s("span",{staticClass:"line-number"},[n._v("62")]),s("br"),s("span",{staticClass:"line-number"},[n._v("63")]),s("br"),s("span",{staticClass:"line-number"},[n._v("64")]),s("br"),s("span",{staticClass:"line-number"},[n._v("65")]),s("br"),s("span",{staticClass:"line-number"},[n._v("66")]),s("br"),s("span",{staticClass:"line-number"},[n._v("67")]),s("br"),s("span",{staticClass:"line-number"},[n._v("68")]),s("br"),s("span",{staticClass:"line-number"},[n._v("69")]),s("br"),s("span",{staticClass:"line-number"},[n._v("70")]),s("br"),s("span",{staticClass:"line-number"},[n._v("71")]),s("br"),s("span",{staticClass:"line-number"},[n._v("72")]),s("br"),s("span",{staticClass:"line-number"},[n._v("73")]),s("br"),s("span",{staticClass:"line-number"},[n._v("74")]),s("br"),s("span",{staticClass:"line-number"},[n._v("75")]),s("br"),s("span",{staticClass:"line-number"},[n._v("76")]),s("br"),s("span",{staticClass:"line-number"},[n._v("77")]),s("br"),s("span",{staticClass:"line-number"},[n._v("78")]),s("br"),s("span",{staticClass:"line-number"},[n._v("79")]),s("br"),s("span",{staticClass:"line-number"},[n._v("80")]),s("br"),s("span",{staticClass:"line-number"},[n._v("81")]),s("br"),s("span",{staticClass:"line-number"},[n._v("82")]),s("br"),s("span",{staticClass:"line-number"},[n._v("83")]),s("br"),s("span",{staticClass:"line-number"},[n._v("84")]),s("br"),s("span",{staticClass:"line-number"},[n._v("85")]),s("br"),s("span",{staticClass:"line-number"},[n._v("86")]),s("br"),s("span",{staticClass:"line-number"},[n._v("87")]),s("br"),s("span",{staticClass:"line-number"},[n._v("88")]),s("br"),s("span",{staticClass:"line-number"},[n._v("89")]),s("br"),s("span",{staticClass:"line-number"},[n._v("90")]),s("br"),s("span",{staticClass:"line-number"},[n._v("91")]),s("br"),s("span",{staticClass:"line-number"},[n._v("92")]),s("br"),s("span",{staticClass:"line-number"},[n._v("93")]),s("br"),s("span",{staticClass:"line-number"},[n._v("94")]),s("br"),s("span",{staticClass:"line-number"},[n._v("95")]),s("br"),s("span",{staticClass:"line-number"},[n._v("96")]),s("br"),s("span",{staticClass:"line-number"},[n._v("97")]),s("br"),s("span",{staticClass:"line-number"},[n._v("98")]),s("br"),s("span",{staticClass:"line-number"},[n._v("99")]),s("br"),s("span",{staticClass:"line-number"},[n._v("100")]),s("br"),s("span",{staticClass:"line-number"},[n._v("101")]),s("br"),s("span",{staticClass:"line-number"},[n._v("102")]),s("br"),s("span",{staticClass:"line-number"},[n._v("103")]),s("br"),s("span",{staticClass:"line-number"},[n._v("104")]),s("br"),s("span",{staticClass:"line-number"},[n._v("105")]),s("br"),s("span",{staticClass:"line-number"},[n._v("106")]),s("br"),s("span",{staticClass:"line-number"},[n._v("107")]),s("br"),s("span",{staticClass:"line-number"},[n._v("108")]),s("br"),s("span",{staticClass:"line-number"},[n._v("109")]),s("br"),s("span",{staticClass:"line-number"},[n._v("110")]),s("br"),s("span",{staticClass:"line-number"},[n._v("111")]),s("br"),s("span",{staticClass:"line-number"},[n._v("112")]),s("br"),s("span",{staticClass:"line-number"},[n._v("113")]),s("br"),s("span",{staticClass:"line-number"},[n._v("114")]),s("br"),s("span",{staticClass:"line-number"},[n._v("115")]),s("br"),s("span",{staticClass:"line-number"},[n._v("116")]),s("br"),s("span",{staticClass:"line-number"},[n._v("117")]),s("br"),s("span",{staticClass:"line-number"},[n._v("118")]),s("br"),s("span",{staticClass:"line-number"},[n._v("119")]),s("br"),s("span",{staticClass:"line-number"},[n._v("120")]),s("br"),s("span",{staticClass:"line-number"},[n._v("121")]),s("br"),s("span",{staticClass:"line-number"},[n._v("122")]),s("br"),s("span",{staticClass:"line-number"},[n._v("123")]),s("br"),s("span",{staticClass:"line-number"},[n._v("124")]),s("br"),s("span",{staticClass:"line-number"},[n._v("125")]),s("br"),s("span",{staticClass:"line-number"},[n._v("126")]),s("br"),s("span",{staticClass:"line-number"},[n._v("127")]),s("br"),s("span",{staticClass:"line-number"},[n._v("128")]),s("br"),s("span",{staticClass:"line-number"},[n._v("129")]),s("br"),s("span",{staticClass:"line-number"},[n._v("130")]),s("br"),s("span",{staticClass:"line-number"},[n._v("131")]),s("br"),s("span",{staticClass:"line-number"},[n._v("132")]),s("br"),s("span",{staticClass:"line-number"},[n._v("133")]),s("br"),s("span",{staticClass:"line-number"},[n._v("134")]),s("br")])]),s("p",[n._v("调用demo:")]),n._v(" "),s("div",{staticClass:"language-golang line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('client := aliyun.AyunClient{\n\t\tAK: "xxx",\n\t\tSK: "xxx",\n\t}\nclient.Init()\nresp, err := client.DestroyInstances("i-xxxx")\n......\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br")])])])}),[],!1,null,null,null);s.default=a.exports}}]);